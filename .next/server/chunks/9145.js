exports.id=9145,exports.ids=[9145],exports.modules={10177:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,81170,23)),Promise.resolve().then(c.t.bind(c,23597,23)),Promise.resolve().then(c.t.bind(c,36893,23)),Promise.resolve().then(c.t.bind(c,89748,23)),Promise.resolve().then(c.t.bind(c,6060,23)),Promise.resolve().then(c.t.bind(c,7184,23)),Promise.resolve().then(c.t.bind(c,69576,23)),Promise.resolve().then(c.t.bind(c,73041,23)),Promise.resolve().then(c.t.bind(c,51384,23))},16953:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>m,metadata:()=>k,viewport:()=>l});var d=c(75338),e=c(81883),f=c.n(e),g=c(13135),h=c.n(g);c(82704),c(87347);var i=c(44327),j=c(99174);let k={title:"Sales Dashboard",description:"Modern sales dashboard with login"},l={width:"device-width",initialScale:1,maximumScale:1,userScalable:!1};function m({children:a}){return(0,d.jsx)("html",{lang:"en",suppressHydrationWarning:!0,children:(0,d.jsx)("body",{className:`${f().variable} ${h().variable} antialiased min-h-screen`,children:(0,d.jsx)(i.ThemeProvider,{defaultTheme:"system",children:(0,d.jsx)(j.AuthProvider,{children:a})})})})}},21884:(a,b,c)=>{"use strict";c.d(b,{A:()=>j,AuthProvider:()=>i});var d=c(21124),e=c(38301),f=c(50849),g=c(42378);let h=(0,e.createContext)(void 0);function i({children:a}){let[b,c]=(0,e.useState)(!1),[i,j]=(0,e.useState)(null),[k,l]=(0,e.useState)(!0),[m,n]=(0,e.useState)(null),[o,p]=(0,e.useState)(null),[q,r]=(0,e.useState)(null);(0,e.useRef)(null);let s=(0,g.useRouter)(),t=async(a,b)=>{l(!0);try{let d=await f.y1.login({username:a,password:b});j(d.token),c(!0);let e=f.y1.getUserRole(),g=f.y1.getUserData(),h=f.y1.getCurrentUser();n(e),p(g),r(h)}catch(a){throw a}finally{l(!1)}},u=async()=>{try{await f.y1.logout(),j(null),c(!1),n(null),p(null),r(null),s.replace("/login")}catch(a){throw j(null),c(!1),n(null),p(null),a}};return(0,d.jsx)(h.Provider,{value:{isAuthenticated:b,token:i,login:t,logout:u,isLoading:k,userRole:m,userData:o,currentUser:q},children:a})}function j(){let a=(0,e.useContext)(h);if(void 0===a)throw Error("useAuth must be used within an AuthProvider");return a}},23329:(a,b,c)=>{Promise.resolve().then(c.t.bind(c,54160,23)),Promise.resolve().then(c.t.bind(c,31603,23)),Promise.resolve().then(c.t.bind(c,68495,23)),Promise.resolve().then(c.t.bind(c,75170,23)),Promise.resolve().then(c.t.bind(c,77526,23)),Promise.resolve().then(c.t.bind(c,78922,23)),Promise.resolve().then(c.t.bind(c,29234,23)),Promise.resolve().then(c.t.bind(c,12263,23)),Promise.resolve().then(c.bind(c,82146))},25196:(a,b,c)=>{Promise.resolve().then(c.bind(c,99174)),Promise.resolve().then(c.bind(c,44327))},44327:(a,b,c)=>{"use strict";c.d(b,{ThemeProvider:()=>e});var d=c(97954);let e=(0,d.registerClientReference)(function(){throw Error("Attempted to call ThemeProvider() from the server but ThemeProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/apple/Desktop/Projects/October/GajkesariSales-Oct23/components/theme-provider.tsx","ThemeProvider");(0,d.registerClientReference)(function(){throw Error("Attempted to call useTheme() from the server but useTheme is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/apple/Desktop/Projects/October/GajkesariSales-Oct23/components/theme-provider.tsx","useTheme")},46055:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>e});var d=c(97523);let e=async a=>[{type:"image/x-icon",sizes:"16x16",url:(0,d.fillMetadataSegment)(".",await a.params,"favicon.ico")+""}]},50849:(a,b,c)=>{"use strict";c.d(b,{N4:()=>j,Xb:()=>i,co:()=>k,y1:()=>m});let d="https://api.gajkesaristeels.in",e=`${d}/user/token`,f=`${d}/user/logout`,g=`${d}/user/manage/get`,h=`${d}/user/manage/current-user`,i=a=>a?a.trim().replace(/\s+/g," ").toUpperCase():null,j=a=>{let b=i(a);return"MANAGER"===b||"ROLE MANAGER"===b||"ROLE_MANAGER"===b||"OFFICE MANAGER"===b||"OFFICE_MANAGER"===b||"ROLE OFFICE MANAGER"===b||"ROLE_OFFICE MANAGER"===b||"ROLE_OFFICE_MANAGER"===b},k=(a,b)=>!!j(a)||(b?.authorities??[]).some(a=>j(a.authority)),l={getToken:()=>null,setToken:a=>{},removeToken:()=>{},getAuthHeader:()=>{let a=l.getToken();return a?`Bearer ${a}`:null},setUserRole:a=>{},getUserRole:()=>null,getUserData:()=>null,setCurrentUser:a=>{},getCurrentUser:()=>null},m={login:async a=>{try{let b=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!b.ok){let a=await b.text();throw Error(`Login failed: ${b.status} ${a}`)}let c=await b.text(),{role:d,token:f}=(a=>{let b=a.trim();if(!b)throw Error("Empty response received from login endpoint");try{let a=JSON.parse(b);if("string"==typeof a.token)return{token:a.token.trim(),role:a.role??"USER"}}catch{}let c=b.split(/\s+/);if(c.length<2)throw Error(`Unexpected login response: "${b}"`);let d=c[0],e=c[c.length-1];if("bearer"===e.toLowerCase()&&c.length>=3&&(e=c[c.length-1]),!(e=e.replace(/^"(.*)"$/,"$1")).includes("."))throw Error(`Parsed token looks invalid: "${e}"`);return{token:e,role:d||"USER"}})(c);l.setToken(f);try{console.log("Fetching role for username:",a.username),console.log("Raw token response:",c),console.log("Token being used:",f);let b=await fetch(`${g}?username=${a.username}`,{credentials:"include",method:"GET",headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"}});if(b.ok){let a=await b.json();l.setUserRole(a),console.log("User role data stored:",a)}else{console.warn("Failed to fetch user role data:",b.status,b.statusText);let a=await b.text();console.warn("Error response:",a)}}catch(a){console.warn("Error fetching user role data:",a)}try{let a=await fetch(h,{credentials:"include",method:"GET",headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"}});if(a.ok){let b=await a.json();l.setCurrentUser(b),console.log("Current user data stored:",b)}else console.warn("Failed to fetch current user data:",a.status)}catch(a){console.warn("Error fetching current user data:",a)}return{token:f,role:d||"USER"}}catch(a){throw console.error("Login error:",a),a}},logout:async()=>{try{let a=l.getToken();if(!a)return void l.removeToken();let b=await fetch(f,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`}});l.removeToken(),b.ok||console.warn("Logout request failed, but token was cleared locally")}catch(a){console.error("Logout error:",a),l.removeToken()}},isAuthenticated:()=>!!l.getToken(),getStoredToken:()=>l.getToken(),getUserRole:()=>l.getUserRole(),getUserData:()=>l.getUserData(),getCurrentUser:()=>l.getCurrentUser()}},64385:(a,b,c)=>{"use strict";c.d(b,{D:()=>h,ThemeProvider:()=>g});var d=c(21124),e=c(38301);let f=(0,e.createContext)({theme:"system",setTheme:()=>null});function g({children:a,defaultTheme:b="system",storageKey:c="ui-theme",...g}){let[h,i]=(0,e.useState)(b);return(0,d.jsx)(f.Provider,{...g,value:{theme:h,setTheme:a=>{localStorage.setItem(c,a),i(a)}},children:a})}let h=()=>{let a=(0,e.useContext)(f);if(void 0===a)throw Error("useTheme must be used within a ThemeProvider");return a}},82704:()=>{},87347:()=>{},88748:(a,b,c)=>{Promise.resolve().then(c.bind(c,21884)),Promise.resolve().then(c.bind(c,64385))},99174:(a,b,c)=>{"use strict";c.d(b,{AuthProvider:()=>e});var d=c(97954);let e=(0,d.registerClientReference)(function(){throw Error("Attempted to call AuthProvider() from the server but AuthProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/apple/Desktop/Projects/October/GajkesariSales-Oct23/components/auth-provider.tsx","AuthProvider");(0,d.registerClientReference)(function(){throw Error("Attempted to call useAuth() from the server but useAuth is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/apple/Desktop/Projects/October/GajkesariSales-Oct23/components/auth-provider.tsx","useAuth")}};