"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8131],{26983:(e,t,r)=>{r.d(t,{A:()=>n});let n=(0,r(71847).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},35626:(e,t,r)=>{r.d(t,{A:()=>n});let n=(0,r(71847).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},55725:(e,t,r)=>{r.d(t,{V:()=>p});var n=r(3648),o=r(95155),a=r(12115),l=r(90368),s=r(27937),u=r(24033),c=r(74854),d=r(45704),i=r(25016),g=r(97003);function m(){let e=(0,n._)(["rtl:**:[.rdp-button_next>svg]:rotate-180"],["rtl:**:[.rdp-button\\_next>svg]:rotate-180"]);return m=function(){return e},e}function f(){let e=(0,n._)(["rtl:**:[.rdp-button_previous>svg]:rotate-180"],["rtl:**:[.rdp-button\\_previous>svg]:rotate-180"]);return f=function(){return e},e}function p(e){let{className:t,classNames:r,showOutsideDays:n=!0,captionLayout:a="label",buttonVariant:p="ghost",formatters:y,components:w,...x}=e,k=(0,c.a)();return(0,o.jsx)(d.h,{showOutsideDays:n,className:(0,i.cn)("bg-background group/calendar p-3 [--cell-size:--spacing(8)] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw(m()),String.raw(f()),t),captionLayout:a,formatters:{formatMonthDropdown:e=>e.toLocaleString("default",{month:"short"}),...y},classNames:{root:(0,i.cn)("w-fit",k.root),months:(0,i.cn)("flex gap-4 flex-col md:flex-row relative",k.months),month:(0,i.cn)("flex flex-col w-full gap-4",k.month),nav:(0,i.cn)("flex items-center gap-1 w-full absolute top-0 inset-x-0 justify-between",k.nav),button_previous:(0,i.cn)((0,g.r)({variant:p}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",k.button_previous),button_next:(0,i.cn)((0,g.r)({variant:p}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",k.button_next),month_caption:(0,i.cn)("flex items-center justify-center h-(--cell-size) w-full px-(--cell-size)",k.month_caption),dropdowns:(0,i.cn)("w-full flex items-center text-sm font-medium justify-center h-(--cell-size) gap-1.5",k.dropdowns),dropdown_root:(0,i.cn)("relative has-focus:border-ring border border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] rounded-md",k.dropdown_root),dropdown:(0,i.cn)("absolute bg-popover inset-0 opacity-0",k.dropdown),caption_label:(0,i.cn)("select-none font-medium","label"===a?"text-sm":"rounded-md pl-2 pr-1 flex items-center gap-1 text-sm h-8 [&>svg]:text-muted-foreground [&>svg]:size-3.5",k.caption_label),table:"w-full border-collapse",weekdays:(0,i.cn)("flex",k.weekdays),weekday:(0,i.cn)("text-muted-foreground rounded-md flex-1 font-normal text-[0.8rem] select-none",k.weekday),week:(0,i.cn)("flex w-full mt-2",k.week),week_number_header:(0,i.cn)("select-none w-(--cell-size)",k.week_number_header),week_number:(0,i.cn)("text-[0.8rem] select-none text-muted-foreground",k.week_number),day:(0,i.cn)("relative w-full h-full p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md group/day aspect-square select-none",k.day),range_start:(0,i.cn)("rounded-l-md bg-accent",k.range_start),range_middle:(0,i.cn)("rounded-none",k.range_middle),range_end:(0,i.cn)("rounded-r-md bg-accent",k.range_end),today:(0,i.cn)("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",k.today),outside:(0,i.cn)("text-muted-foreground aria-selected:text-muted-foreground",k.outside),disabled:(0,i.cn)("text-muted-foreground opacity-50",k.disabled),hidden:(0,i.cn)("invisible",k.hidden),...r},components:{Root:e=>{let{className:t,rootRef:r,...n}=e;return(0,o.jsx)("div",{"data-slot":"calendar",ref:r,className:(0,i.cn)(t),...n})},Chevron:e=>{let{className:t,orientation:r,...n}=e;return"left"===r?(0,o.jsx)(l.A,{className:(0,i.cn)("size-4",t),...n}):"right"===r?(0,o.jsx)(s.A,{className:(0,i.cn)("size-4",t),...n}):(0,o.jsx)(u.A,{className:(0,i.cn)("size-4",t),...n})},DayButton:h,WeekNumber:e=>{let{children:t,...r}=e;return(0,o.jsx)("td",{...r,children:(0,o.jsx)("div",{className:"flex size-(--cell-size) items-center justify-center text-center",children:t})})},...w},...x})}function h(e){let{className:t,day:r,modifiers:n,...l}=e,s=(0,c.a)(),u=a.useRef(null);return a.useEffect(()=>{var e;n.focused&&(null==(e=u.current)||e.focus())},[n.focused]),(0,o.jsx)(g.$,{ref:u,variant:"ghost",size:"icon","data-day":r.date.toLocaleDateString(),"data-selected-single":n.selected&&!n.range_start&&!n.range_end&&!n.range_middle,"data-range-start":n.range_start,"data-range-end":n.range_end,"data-range-middle":n.range_middle,className:(0,i.cn)("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 dark:hover:text-accent-foreground flex aspect-square size-auto w-full min-w-(--cell-size) flex-col gap-1 leading-none font-normal group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] data-[range-end=true]:rounded-md data-[range-end=true]:rounded-r-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md data-[range-start=true]:rounded-l-md [&>span]:text-xs [&>span]:opacity-70",s.day,t),...l})}},68209:(e,t,r)=>{r.d(t,{N4:()=>c,Xb:()=>u,co:()=>d,y1:()=>g});let n="https://api.gajkesaristeels.in",o="".concat(n,"/user/token"),a="".concat(n,"/user/logout"),l="".concat(n,"/user/manage/get"),s="".concat(n,"/user/manage/current-user"),u=e=>e?e.trim().replace(/\s+/g," ").toUpperCase():null,c=e=>{let t=u(e);return"MANAGER"===t||"ROLE MANAGER"===t||"ROLE_MANAGER"===t||"OFFICE MANAGER"===t||"OFFICE_MANAGER"===t||"ROLE OFFICE MANAGER"===t||"ROLE_OFFICE MANAGER"===t||"ROLE_OFFICE_MANAGER"===t},d=(e,t)=>{var r;return!!c(e)||(null!=(r=null==t?void 0:t.authorities)?r:[]).some(e=>c(e.authority))},i={getToken:()=>localStorage.getItem("authToken"),setToken:e=>{{localStorage.setItem("authToken",e);let t="localhost"===window.location.hostname?"authToken=".concat(e,"; path=/; max-age=86400; samesite=strict"):"authToken=".concat(e,"; path=/; max-age=86400; secure; samesite=strict");document.cookie=t}},removeToken:()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userData"),localStorage.removeItem("currentUser"),document.cookie="authToken=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT"},getAuthHeader:()=>{let e=i.getToken();return e?"Bearer ".concat(e):null},setUserRole:e=>{localStorage.setItem("userRole",e.roles),localStorage.setItem("userData",JSON.stringify(e))},getUserRole:()=>localStorage.getItem("userRole"),getUserData:()=>{{let e=localStorage.getItem("userData");return e?JSON.parse(e):null}},setCurrentUser:e=>{localStorage.setItem("currentUser",JSON.stringify(e))},getCurrentUser:()=>{{let e=localStorage.getItem("currentUser");return e?JSON.parse(e):null}}},g={login:async e=>{try{let t=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e=await t.text();throw Error("Login failed: ".concat(t.status," ").concat(e))}let r=await t.text(),{role:n,token:a}=(e=>{let t=e.trim();if(!t)throw Error("Empty response received from login endpoint");try{let e=JSON.parse(t);if("string"==typeof e.token){var r;return{token:e.token.trim(),role:null!=(r=e.role)?r:"USER"}}}catch(e){}let n=t.split(/\s+/);if(n.length<2)throw Error('Unexpected login response: "'.concat(t,'"'));let o=n[0],a=n[n.length-1];if("bearer"===a.toLowerCase()&&n.length>=3&&(a=n[n.length-1]),!(a=a.replace(/^"(.*)"$/,"$1")).includes("."))throw Error('Parsed token looks invalid: "'.concat(a,'"'));return{token:a,role:o||"USER"}})(r);i.setToken(a);try{console.log("Fetching role for username:",e.username),console.log("Raw token response:",r),console.log("Token being used:",a);let t=await fetch("".concat(l,"?username=").concat(e.username),{credentials:"include",method:"GET",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}});if(t.ok){let e=await t.json();i.setUserRole(e),console.log("User role data stored:",e)}else{console.warn("Failed to fetch user role data:",t.status,t.statusText);let e=await t.text();console.warn("Error response:",e)}}catch(e){console.warn("Error fetching user role data:",e)}try{let e=await fetch(s,{credentials:"include",method:"GET",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}});if(e.ok){let t=await e.json();i.setCurrentUser(t),console.log("Current user data stored:",t)}else console.warn("Failed to fetch current user data:",e.status)}catch(e){console.warn("Error fetching current user data:",e)}return{token:a,role:n||"USER"}}catch(e){throw console.error("Login error:",e),e}},logout:async()=>{try{let e=i.getToken();if(!e)return void i.removeToken();let t=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});i.removeToken(),t.ok||console.warn("Logout request failed, but token was cleared locally")}catch(e){console.error("Logout error:",e),i.removeToken()}},isAuthenticated:()=>!!i.getToken(),getStoredToken:()=>i.getToken(),getUserRole:()=>i.getUserRole(),getUserData:()=>i.getUserData(),getCurrentUser:()=>i.getCurrentUser()}},82466:(e,t,r)=>{r.d(t,{A:()=>c,AuthProvider:()=>u});var n=r(95155),o=r(12115),a=r(68209),l=r(20063);let s=(0,o.createContext)(void 0);function u(e){let{children:t}=e,[r,u]=(0,o.useState)(!1),[c,d]=(0,o.useState)(null),[i,g]=(0,o.useState)(!0),[m,f]=(0,o.useState)(null),[p,h]=(0,o.useState)(null),[y,w]=(0,o.useState)(null),x=(0,o.useRef)(null),k=(0,l.useRouter)(),b=e=>{if(!e)return null;let t=e.split(".");if(t.length<2)return null;try{let e=t[1].replace(/-/g,"+").replace(/_/g,"/");if("function"!=typeof atob)return null;let r=atob(e),n=JSON.parse(r);if("number"==typeof n.exp)return n.exp;return null}catch(e){return null}};(0,o.useEffect)(()=>{let e=a.y1.getStoredToken(),t=a.y1.getUserRole(),r=a.y1.getUserData(),n=a.y1.getCurrentUser();if(e){let o=b(e),l=Math.floor(Date.now()/1e3);o&&o<=l?a.y1.logout().finally(()=>{d(null),u(!1),f(null),h(null),w(null),k.replace("/login")}):(d(e),u(!0),f(t),h(r),w(n))}g(!1)},[]);let v=async(e,t)=>{g(!0);try{let r=await a.y1.login({username:e,password:t});d(r.token),u(!0);let n=a.y1.getUserRole(),o=a.y1.getUserData(),l=a.y1.getCurrentUser();f(n),h(o),w(l)}catch(e){throw e}finally{g(!1)}},_=async()=>{try{await a.y1.logout(),d(null),u(!1),f(null),h(null),w(null),sessionStorage.removeItem("pricingModalDismissed"),k.replace("/login")}catch(e){throw d(null),u(!1),f(null),h(null),sessionStorage.removeItem("pricingModalDismissed"),e}};return(0,o.useEffect)(()=>{if(x.current&&(clearTimeout(x.current),x.current=null),!c)return;let e=b(c);if(!e)return;let t=1e3*e-Date.now();return t<=0?void _():(x.current=setTimeout(()=>{_()},t),()=>{x.current&&(clearTimeout(x.current),x.current=null)})},[c]),(0,n.jsx)(s.Provider,{value:{isAuthenticated:r,token:c,login:v,logout:_,isLoading:i,userRole:m,userData:p,currentUser:y},children:t})}function c(){let e=(0,o.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}}}]);