(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9564],{35603:()=>{},79564:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>L});var r=n(95155),s=n(12115);let l=(0,s.createContext)(null);function i(){let e=(0,s.use)(l);if(null==e)throw Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return e}var a=n(55027),o=n.n(a);let c=(0,s.forwardRef)(function({bounds:e,boundsOptions:t,center:n,children:r,className:i,id:o,placeholder:c,style:u,whenReady:d,zoom:m,...p},x){let[f]=(0,s.useState)({className:i,id:o,style:u}),[h,g]=(0,s.useState)(null),v=(0,s.useRef)(void 0);(0,s.useImperativeHandle)(x,()=>h?.map??null,[h]);let y=(0,s.useCallback)(r=>{if(null!==r&&!v.current){let s=new a.Map(r,p);v.current=s,null!=n&&null!=m?s.setView(n,m):null!=e&&s.fitBounds(e,t),null!=d&&s.whenReady(d),g(Object.freeze({__version:1,map:s}))}},[]);(0,s.useEffect)(()=>()=>{h?.map.remove()},[h]);let b=h?s.createElement(l,{value:h},r):c??null;return s.createElement("div",{...f,ref:y},b)});var u=n(47650);function d(e,t){let n=(0,s.useRef)(t);(0,s.useEffect)(function(){t!==n.current&&null!=e.attributionControl&&(null!=n.current&&e.attributionControl.removeAttribution(n.current),null!=t&&e.attributionControl.addAttribution(t)),n.current=t},[e,t])}function m(e,t){let n=(0,s.useRef)(void 0);(0,s.useEffect)(function(){return null!=t&&e.instance.on(t),n.current=t,function(){null!=n.current&&e.instance.off(n.current),n.current=null}},[e,t])}function p(e,t){let n=e.pane??t.pane;return n?{...e,pane:n}:e}function x(e,t,n){return Object.freeze({instance:e,context:t,container:n})}function f(e,t){return null==t?function(t,n){let r=(0,s.useRef)(void 0);return r.current||(r.current=e(t,n)),r}:function(n,r){let l=(0,s.useRef)(void 0);l.current||(l.current=e(n,r));let i=(0,s.useRef)(n),{instance:a}=l.current;return(0,s.useEffect)(function(){i.current!==n&&(t(a,n,i.current),i.current=n)},[a,n,t]),l}}function h(e){return function(t){var n;let r=i(),l=e(p(t,r),r);return d(r.map,t.attribution),m(l.current,t.eventHandlers),n=l.current,(0,s.useEffect)(function(){return(r.layerContainer??r.map).addLayer(n.instance),function(){r.layerContainer?.removeLayer(n.instance),r.map.removeLayer(n.instance)}},[r,n]),l}}let g=function(e,t){var n;return n=h(f(e,t)),(0,s.forwardRef)(function(e,t){let{instance:r}=n(e).current;return(0,s.useImperativeHandle)(t,()=>r),null})}(function({url:e,...t},n){return x(new a.TileLayer(e,p(t,n)),n)},function(e,t,n){let{opacity:r,zIndex:s}=t;null!=r&&r!==n.opacity&&e.setOpacity(r),null!=s&&s!==n.zIndex&&e.setZIndex(s);let{url:l}=t;null!=l&&l!==n.url&&e.setUrl(l)}),v=function(e,t){var n;return n=h(f(e,t)),(0,s.forwardRef)(function(e,t){let{instance:r,context:i}=n(e).current;(0,s.useImperativeHandle)(t,()=>r);let{children:a}=e;return null==a?null:s.createElement(l,{value:i},a)})}(function({position:e,...t},n){var r;let s=new a.Marker(e,t);return x(s,(r={overlayContainer:s},Object.freeze({...n,...r})))},function(e,t,n){t.position!==n.position&&e.setLatLng(t.position),null!=t.icon&&t.icon!==n.icon&&e.setIcon(t.icon),null!=t.zIndexOffset&&t.zIndexOffset!==n.zIndexOffset&&e.setZIndexOffset(t.zIndexOffset),null!=t.opacity&&t.opacity!==n.opacity&&e.setOpacity(t.opacity),null!=e.dragging&&t.draggable!==n.draggable&&(!0===t.draggable?e.dragging.enable():e.dragging.disable())}),y=function(e,t){var n,r;return n=f(e),r=function(e,r){let s=i(),l=n(p(e,s),s);return d(s.map,e.attribution),m(l.current,e.eventHandlers),t(l.current,s,e,r),l},(0,s.forwardRef)(function(e,t){let[n,l]=(0,s.useState)(!1),{instance:i}=r(e,l).current;(0,s.useImperativeHandle)(t,()=>i),(0,s.useEffect)(function(){n&&i.update()},[i,n,e.children]);let a=i._contentNode;return a?(0,u.createPortal)(e.children,a):null})}(function(e,t){return x(new a.Popup(e,t.overlayContainer),t)},function(e,t,{position:n},r){(0,s.useEffect)(function(){let{instance:s}=e;function l(e){e.popup===s&&(s.update(),r(!0))}function i(e){e.popup===s&&r(!1)}return t.map.on({popupopen:l,popupclose:i}),null==t.overlayContainer?(null!=n&&s.setLatLng(n),s.openOn(t.map)):t.overlayContainer.bindPopup(s),function(){t.map.off({popupopen:l,popupclose:i}),t.overlayContainer?.unbindPopup(),t.map.removeLayer(s)}},[e,t,r,n])});n(35603),delete o().Icon.Default.prototype._getIconUrl,o().Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});let b=["#ef4444","#3b82f6","#10b981","#f59e0b","#8b5cf6","#ec4899","#06b6d4","#84cc16","#f97316","#6366f1","#14b8a6","#a855f7","#e11d48","#0ea5e9","#22c55e","#facc15"],j=(e,t)=>{let n="house"===t?"36px":"40px";return o().divIcon({className:"custom-marker",html:'<div style="\n      background-color: '.concat(e,";\n      width: ").concat(n,";\n      height: ").concat(n,";\n      border-radius: ").concat("square"==("house"===t?"square":"circle")?"8px":"50%",';\n      border: 3px solid white;\n      box-shadow: 0 4px 8px rgba(0,0,0,0.4);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      position: relative;\n      font-size: 16px;\n      cursor: pointer;\n      touch-action: manipulation;\n    ">\n      ').concat("house"===t?"\uD83C\uDFE0":"visit"===t?"\uD83D\uDCCD":"\uD83D\uDC64","\n    </div>"),iconSize:"house"===t?[36,36]:[40,40],iconAnchor:"house"===t?[18,18]:[20,20]})},w=e=>e?e.listId?e.listId:e.id?e.id:e.location?e.location:String(e):null,N=e=>{let{center:t,zoom:n}=e,r=i().map;return(0,s.useEffect)(()=>{try{r.flyTo(t,n,{duration:.8})}catch(e){}},[t[0],t[1],n]),null},k=(0,s.memo)(e=>{let{center:t,zoom:n,highlightedEmployee:l,markers:i=[],onMarkerClick:a}=e,[o,u]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{u(!0)},[]),o)?(0,r.jsxs)(c,{center:t,zoom:n,style:{height:"100%",width:"100%"},className:"rounded-xl",children:[(0,r.jsx)(N,{center:t,zoom:n}),(0,r.jsx)(g,{url:"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors \xa9 <a href="https://carto.com/attributions">CARTO</a>',subdomains:"abcd",maxZoom:20}),i.map(e=>{console.log("Rendering marker:",e);let t=e.type||"live",n=(e=>b[("string"==typeof e?parseInt(e):e)%b.length])(e.employeeId||e.id);if(e.id&&String(e.id).startsWith("no-location-")){let t=j("#6B7280","live");return(0,r.jsx)(v,{position:[e.lat,e.lng],icon:t,children:(0,r.jsx)(y,{children:(0,r.jsx)("div",{className:"min-w-[320px] max-w-[400px] sm:min-w-[350px] sm:max-w-[450px]",children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-gray-100",children:(0,r.jsxs)("svg",{className:"h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"\uD83D\uDCCD Location Data Unavailable"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:e.name||"Employee Location Information"})]})]}),(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,r.jsx)("p",{className:"text-sm text-gray-700 mb-2",children:"No location information is currently available for this employee."}),(0,r.jsxs)("div",{className:"text-xs text-gray-600",children:[(0,r.jsx)("p",{className:"font-medium mb-1",children:"This could be due to:"}),(0,r.jsxs)("ul",{className:"space-y-1 list-disc list-inside",children:[(0,r.jsx)("li",{children:"Location services disabled on their device"}),(0,r.jsx)("li",{children:"No recent location updates"}),(0,r.jsx)("li",{children:"Data synchronization in progress"}),(0,r.jsx)("li",{children:"Privacy settings restricting location sharing"})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[(0,r.jsx)("svg",{className:"h-3 w-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsx)("span",{children:"Contact the employee to enable location services"})]})]})})})},String(e.id))}let s=j(n,t);return isNaN(e.lat)||isNaN(e.lng)||0===e.lat||0===e.lng?(console.log("Skipping marker with invalid coordinates:",e),null):(0,r.jsx)(v,{position:[e.lat,e.lng],icon:s,eventHandlers:a?{click:()=>a(e)}:void 0,children:(0,r.jsx)(y,{children:(0,r.jsx)("div",{className:"min-w-[280px] max-w-[320px] sm:min-w-[300px] sm:max-w-[350px]",children:"visit"===t?(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"h-3 w-3 rounded-full",style:{backgroundColor:n}}),(0,r.jsx)("span",{className:"text-sm sm:text-base font-semibold text-gray-900",children:e.name||"Visit"})]}),e.tooltipLines&&e.tooltipLines.length>0&&(0,r.jsx)("div",{className:"space-y-2",children:e.tooltipLines.map((e,t)=>{let[n,s]=e.split(": ");return(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-1 sm:gap-2",children:[(0,r.jsxs)("span",{className:"text-xs sm:text-sm font-medium text-gray-600 sm:min-w-[80px]",children:[n,":"]}),(0,r.jsx)("span",{className:"text-xs sm:text-sm text-gray-800 sm:text-right break-words",children:s})]},t)})}),(0,r.jsx)("div",{className:"pt-2 border-t border-gray-200",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[(0,r.jsx)("span",{className:"inline-flex items-center rounded-full px-2 py-1 text-xs sm:text-sm font-medium text-white",style:{backgroundColor:n},children:"Visit Location"}),e.subtitle&&(0,r.jsx)("span",{className:"text-xs sm:text-sm text-gray-500 break-words",children:e.subtitle})]})})]}):(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"text-sm sm:text-base font-semibold",children:e.name||"Employee"}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[(0,r.jsx)("span",{className:"inline-flex items-center rounded-full px-2 py-1 text-xs sm:text-sm font-medium text-white",style:{backgroundColor:n},children:"live"===t?"Live location":"house"===t?"Home location":"Location"}),e.subtitle&&(0,r.jsxs)("span",{className:"text-xs sm:text-sm text-muted-foreground break-words",children:["live"===t?"Updated: ":"",e.subtitle]})]}),e.tooltipLines&&e.tooltipLines.length>0&&(0,r.jsx)("div",{className:"mt-2 space-y-1",children:e.tooltipLines.map((e,t)=>(0,r.jsx)("div",{className:"text-xs sm:text-sm text-muted-foreground break-words",children:e},t))})]})})})},String(e.id))})]}):(0,r.jsx)("div",{className:"h-full w-full bg-gray-100 rounded-xl flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-gray-500",children:"Loading map..."})})},(e,t)=>e.zoom===t.zoom&&e.center[0]===t.center[0]&&e.center[1]===t.center[1]&&w(e.highlightedEmployee)===w(t.highlightedEmployee));k.displayName="LeafletMap";let L=k}}]);