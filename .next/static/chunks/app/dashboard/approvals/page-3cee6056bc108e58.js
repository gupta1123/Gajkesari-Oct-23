(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[154],{16485:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},19324:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>q});var s=a(95155),r=a(12115),n=a(78874),l=a(86651),i=a(66955),o=a(26983),c=a(42529),d=a(20508),u=a(16485),m=a(56069),h=a(37621),f=a(83209),p=a(97003),x=a(33789),g=a(67812),v=a(47507),j=a(68122),y=a(60296),w=a(94416),b=a(86553),N=a(59686),k=a(81402),C=a(53127);function A(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}class E extends r.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,a=(0,k.s)(e)&&e.offsetWidth||0,s=this.props.sizeRef.current;s.height=t.offsetHeight||0,s.width=t.offsetWidth||0,s.top=t.offsetTop,s.left=t.offsetLeft,s.right=a-s.width-s.left}return null}componentDidUpdate(){}render(){return this.props.children}}function S(e){let{children:t,isPresent:a,anchorX:n,root:l}=e,i=(0,r.useId)(),o=(0,r.useRef)(null),c=(0,r.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:d}=(0,r.useContext)(C.Q),u=function(...e){return r.useCallback(function(...e){return t=>{let a=!1,s=e.map(e=>{let s=A(e,t);return a||"function"!=typeof s||(a=!0),s});if(a)return()=>{for(let t=0;t<s.length;t++){let a=s[t];"function"==typeof a?a():A(e[t],null)}}}}(...e),e)}(o,null==t?void 0:t.ref);return(0,r.useInsertionEffect)(()=>{let{width:e,height:t,top:s,left:r,right:u}=c.current;if(a||!o.current||!e||!t)return;o.current.dataset.motionPopId=i;let m=document.createElement("style");d&&(m.nonce=d);let h=null!=l?l:document.head;return h.appendChild(m),m.sheet&&m.sheet.insertRule('\n          [data-motion-pop-id="'.concat(i,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            ").concat("left"===n?"left: ".concat(r):"right: ".concat(u),"px !important;\n            top: ").concat(s,"px !important;\n          }\n        ")),()=>{h.contains(m)&&h.removeChild(m)}},[a]),(0,s.jsx)(E,{isPresent:a,childRef:o,sizeRef:c,children:r.cloneElement(t,{ref:u})})}let R=e=>{let{children:t,initial:a,isPresent:n,onExitComplete:l,custom:i,presenceAffectsLayout:o,mode:c,anchorX:d,root:u}=e,m=(0,w.M)(T),h=(0,r.useId)(),f=!0,p=(0,r.useMemo)(()=>(f=!1,{id:h,initial:a,isPresent:n,custom:i,onExitComplete:e=>{for(let t of(m.set(e,!0),m.values()))if(!t)return;l&&l()},register:e=>(m.set(e,!1),()=>m.delete(e))}),[n,m,l]);return o&&f&&(p={...p}),(0,r.useMemo)(()=>{m.forEach((e,t)=>m.set(t,!1))},[n]),r.useEffect(()=>{n||m.size||!l||l()},[n]),"popLayout"===c&&(t=(0,s.jsx)(S,{isPresent:n,anchorX:d,root:u,children:t})),(0,s.jsx)(N.t.Provider,{value:p,children:t})};function T(){return new Map}var D=a(75601);let z=e=>e.key||"";function I(e){let t=[];return r.Children.forEach(e,e=>{(0,r.isValidElement)(e)&&t.push(e)}),t}let U=e=>{let{children:t,custom:a,initial:n=!0,onExitComplete:l,presenceAffectsLayout:i=!0,mode:o="sync",propagate:c=!1,anchorX:d="left",root:u}=e,[m,h]=(0,D.xQ)(c),f=(0,r.useMemo)(()=>I(t),[t]),p=c&&!m?[]:f.map(z),x=(0,r.useRef)(!0),g=(0,r.useRef)(f),v=(0,w.M)(()=>new Map),[j,N]=(0,r.useState)(f),[k,C]=(0,r.useState)(f);(0,b.E)(()=>{x.current=!1,g.current=f;for(let e=0;e<k.length;e++){let t=z(k[e]);p.includes(t)?v.delete(t):!0!==v.get(t)&&v.set(t,!1)}},[k,p.length,p.join("-")]);let A=[];if(f!==j){let e=[...f];for(let t=0;t<k.length;t++){let a=k[t],s=z(a);p.includes(s)||(e.splice(t,0,a),A.push(a))}return"wait"===o&&A.length&&(e=A),C(I(e)),N(f),null}let{forceRender:E}=(0,r.useContext)(y.L);return(0,s.jsx)(s.Fragment,{children:k.map(e=>{let t=z(e),r=(!c||!!m)&&(f===k||p.includes(t));return(0,s.jsx)(R,{isPresent:r,initial:(!x.current||!!n)&&void 0,custom:a,presenceAffectsLayout:i,mode:o,root:u,onExitComplete:r?void 0:()=>{if(!v.has(t))return;v.set(t,!0);let e=!0;v.forEach(t=>{t||(e=!1)}),e&&(null==E||E(),C(g.current),c&&(null==h||h()),l&&l())},anchorX:d,children:e},t)})})};var P=a(1733),L=a(31856);let q=()=>{let{token:e,userData:t}=(0,m.A)(),[a,y]=(0,r.useState)([]),[w,b]=(0,r.useState)(!0),[N,k]=(0,r.useState)(null),[C,A]=(0,r.useState)({}),[E,S]=(0,r.useState)(""),[R,T]=(0,r.useState)("all"),[D,z]=(0,r.useState)("date"),[I,q]=(0,r.useState)(!1),[F,M]=(0,r.useState)(!1),[O,_]=(0,r.useState)(!1),[$,B]=(0,r.useState)(!1),[J,W]=(0,r.useState)(null),[G,V]=(0,r.useState)(null),[Z,H]=(0,r.useState)(!1),[X,Q]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{if(e)try{let t=await fetch("https://api.gajkesaristeels.in/user/manage/current-user",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(t.ok){let e=await t.json();console.log("Current user data:",e);let a=e.authorities||[],s=a.length>0?a[0].authority:null;W(s),M("ROLE_MANAGER"===s),_("ROLE_ADMIN"===s),B("ROLE_FIELD OFFICER"===s),console.log("Role from API:",s),console.log("isManager:","ROLE_MANAGER"===s),console.log("isAdmin:","ROLE_ADMIN"===s),console.log("isFieldOfficer:","ROLE_FIELD OFFICER"===s)}else console.error("Failed to fetch current user data")}catch(e){console.error("Error fetching current user:",e)}})()},[e]),(0,r.useEffect)(()=>{(async()=>{if((F||$)&&(null==t?void 0:t.employeeId)){H(!0),Q(null);try{let e=await h.n.getTeamByEmployee(t.employeeId);e.length>0?V(e[0].id):(Q("No team data found for this user"),V(6))}catch(e){console.error("Failed to load team data:",e),Q("Failed to load team data"),V(6)}finally{H(!1)}}})()},[F,$,null==t?void 0:t.employeeId]),(0,r.useEffect)(()=>{e&&Y()},[e,G]);let Y=async()=>{if(e&&(!F&&!$||null!=G))try{b(!0);let t="https://api.gajkesaristeels.in/request/getByStatus?status=pending";console.log("Attendance requests API call:",t);let a=await fetch(t,{headers:{Authorization:"Bearer ".concat(e)}}),s=await a.json();y(s)}catch(e){k("Failed to fetch pending requests. Please try again later.")}finally{b(!1)}},K=async(t,s)=>{var r;if(!e)return;let n=C[t]||(null==(r=a.find(e=>e.id===t))?void 0:r.requestedStatus)||"full day";try{await fetch("https://api.gajkesaristeels.in/request/updateStatus?id=".concat(t,"&status=").concat(s,"&attendance=").concat(encodeURIComponent(n)),{method:"PUT",headers:{Authorization:"Bearer ".concat(e),requestId:t.toString()}}),await Y(),A(e=>({...e,[t]:null}))}catch(e){k("Failed to update request status. Please try again.")}},ee=(e,t)=>{A(a=>({...a,[e]:t}))},et=(0,r.useMemo)(()=>Object.values(a.filter(e=>{var t;let a=e.employeeName.toLowerCase().includes(E.toLowerCase()),s="all"===R||(null==(t=e.status)?void 0:t.toLowerCase())===R;return a&&s}).reduce((e,t)=>{let a="".concat(t.employeeId,"-").concat(t.requestDate);return e[a]||(e[a]=[]),e[a].push(t),e},{})).flatMap(e=>e.length>1?e.map((t,a)=>({...t,isDuplicate:!0,duplicateCount:e.length,duplicateIndex:a+1})):e).sort((e,t)=>{switch(D){case"name":return e.employeeName.localeCompare(t.employeeName);case"status":return(e.status||"").localeCompare(t.status||"");default:return new Date(t.requestDate).getTime()-new Date(e.requestDate).getTime()}}),[a,E,R,D]),ea=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),es=(()=>{let e={all:a.length,pending:0,approved:0,rejected:0};return a.forEach(t=>{var a;let s=null==(a=t.status)?void 0:a.toLowerCase();"pending"===s&&e.pending++,"approved"===s&&e.approved++,"rejected"===s&&e.rejected++}),e})();return w?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(j.E,{className:"h-8 w-48"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(j.E,{className:"h-10 w-64"}),(0,s.jsx)(j.E,{className:"h-10 w-32"})]})]}),(0,s.jsx)("div",{className:"grid gap-4",children:[...Array(6)].map((e,t)=>(0,s.jsx)(f.Zp,{children:(0,s.jsxs)(f.Wu,{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)(j.E,{className:"h-5 w-32"}),(0,s.jsx)(j.E,{className:"h-6 w-16"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(j.E,{className:"h-4 w-full"}),(0,s.jsx)(j.E,{className:"h-4 w-3/4"})]})]})},t))})]}):N?(0,s.jsx)("div",{className:"space-y-6",children:(0,s.jsx)(f.Zp,{children:(0,s.jsxs)(f.Wu,{className:"p-8 text-center",children:[(0,s.jsx)(n.A,{className:"h-12 w-12 text-destructive mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Error Loading Requests"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-4",children:N}),(0,s.jsx)(p.$,{onClick:Y,children:"Try Again"})]})})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,s.jsx)("div",{children:(F||$)&&(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:(0,s.jsx)("p",{children:Z?"Loading team data...":X?"Error: ".concat(X," (Using fallback Team ID: ").concat(G,")"):G?"Team-based view (Team ID: ".concat(G,")"):"No team data available"})})}),(0,s.jsxs)(g.E,{variant:"outline",className:"text-sm",children:[et.length," requests"]})]}),(0,s.jsxs)(f.Zp,{children:[(0,s.jsx)(f.aR,{className:"pb-4",children:(0,s.jsx)("div",{className:"flex flex-col sm:flex-row justify-between gap-4",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 flex-1",children:[(0,s.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,s.jsx)(l.A,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,s.jsx)(x.p,{placeholder:"Search by employee name...",className:"pl-10",value:E,onChange:e=>S(e.target.value)})]}),(0,s.jsxs)(L.cj,{open:I,onOpenChange:q,children:[(0,s.jsx)(L.CG,{asChild:!0,children:(0,s.jsxs)(p.$,{variant:"outline",className:"sm:hidden",children:[(0,s.jsx)(i.A,{className:"mr-2 h-4 w-4"}),"Filters"]})}),(0,s.jsxs)(L.h,{side:"left",className:"w-64 sm:w-80",children:[(0,s.jsx)(L.Fm,{children:(0,s.jsx)(L.qp,{children:"Filters"})}),(0,s.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Status"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(p.$,{variant:"all"===R?"default":"outline",onClick:()=>T("all"),className:"w-full justify-between",children:[(0,s.jsx)("span",{children:"All Requests"}),(0,s.jsx)(g.E,{variant:"secondary",className:"ml-2",children:es.all})]}),(0,s.jsxs)(p.$,{variant:"pending"===R?"default":"outline",onClick:()=>T("pending"),className:"w-full justify-between",children:[(0,s.jsx)("span",{children:"Pending"}),(0,s.jsx)(g.E,{variant:"secondary",className:"ml-2",children:es.pending})]}),(0,s.jsxs)(p.$,{variant:"approved"===R?"default":"outline",onClick:()=>T("approved"),className:"w-full justify-between",children:[(0,s.jsx)("span",{children:"Approved"}),(0,s.jsx)(g.E,{variant:"secondary",className:"ml-2",children:es.approved})]}),(0,s.jsxs)(p.$,{variant:"rejected"===R?"default":"outline",onClick:()=>T("rejected"),className:"w-full justify-between",children:[(0,s.jsx)("span",{children:"Rejected"}),(0,s.jsx)(g.E,{variant:"secondary",className:"ml-2",children:es.rejected})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Sort By"}),(0,s.jsxs)(v.l6,{value:D,onValueChange:e=>z(e),children:[(0,s.jsx)(v.bq,{children:(0,s.jsx)(v.yv,{placeholder:"Sort by"})}),(0,s.jsxs)(v.gC,{children:[(0,s.jsx)(v.eb,{value:"date",children:"Date"}),(0,s.jsx)(v.eb,{value:"name",children:"Name"}),(0,s.jsx)(v.eb,{value:"status",children:"Status"})]})]})]})]})]}),(0,s.jsxs)("div",{className:"hidden sm:flex gap-2",children:[(0,s.jsxs)(p.$,{variant:"all"===R?"default":"outline",onClick:()=>T("all"),size:"sm",children:[(0,s.jsx)(o.A,{className:"mr-2 h-4 w-4"}),"All (",es.all,")"]}),(0,s.jsxs)(p.$,{variant:"pending"===R?"default":"outline",onClick:()=>T("pending"),size:"sm",children:[(0,s.jsx)(o.A,{className:"mr-2 h-4 w-4"}),"Pending (",es.pending,")"]}),(0,s.jsxs)(p.$,{variant:"approved"===R?"default":"outline",onClick:()=>T("approved"),size:"sm",children:[(0,s.jsx)(c.A,{className:"mr-2 h-4 w-4"}),"Approved (",es.approved,")"]}),(0,s.jsxs)(p.$,{variant:"rejected"===R?"default":"outline",onClick:()=>T("rejected"),size:"sm",children:[(0,s.jsx)(n.A,{className:"mr-2 h-4 w-4"}),"Rejected (",es.rejected,")"]})]})]})]})})}),(0,s.jsx)(f.Wu,{children:(0,s.jsx)(U,{children:0===et.length?(0,s.jsx)(P.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:(0,s.jsx)(f.Zp,{children:(0,s.jsxs)(f.Wu,{className:"p-12 text-center",children:[(0,s.jsx)(d.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No requests found"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:E||"all"!==R?"Try adjusting your search or filter criteria.":"There are no pending requests at the moment."})]})})}):(0,s.jsx)("div",{className:"grid gap-4",children:et.map((e,t)=>{var a;return(0,s.jsx)(P.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{delay:.05*t},children:(0,s.jsx)(f.Zp,{className:"hover:shadow-md transition-shadow ".concat(e.isDuplicate?"border-orange-200 bg-orange-50/50":""),children:(0,s.jsx)(f.Wu,{className:"p-4",children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[(0,s.jsx)("div",{className:"p-2 rounded-full ".concat(e.isDuplicate?"bg-orange-100":"bg-primary/10"),children:(0,s.jsx)(d.A,{className:"h-4 w-4 ".concat(e.isDuplicate?"text-orange-600":"text-primary")})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("h3",{className:"font-semibold text-lg truncate",children:e.employeeName}),e.isDuplicate&&(0,s.jsxs)(g.E,{variant:"outline",className:"text-orange-600 border-orange-300 bg-orange-100",children:["Duplicate ",e.duplicateIndex,"/",e.duplicateCount]})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-4 text-sm text-muted-foreground mt-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(u.A,{className:"h-3 w-3"}),(0,s.jsxs)("span",{children:["Request Date: ",ea(e.requestDate)]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(o.A,{className:"h-3 w-3"}),(0,s.jsxs)("span",{children:["Log Date: ",ea(e.logDate)]})]}),(0,s.jsx)("div",{className:"flex items-center gap-1",children:(0,s.jsxs)("span",{children:["Requested: ",e.requestedStatus]})}),e.actionDate&&(0,s.jsx)("div",{className:"flex items-center gap-1",children:(0,s.jsxs)("span",{children:["Action Date: ",ea(e.actionDate)]})})]})]})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3",children:[(0,s.jsx)(g.E,{variant:(e=>{if(!e)return"outline";switch(e.toLowerCase()){case"approved":return"default";case"rejected":return"destructive";case"pending":return"secondary";default:return"outline"}})(e.status),children:e.status||"Unknown"}),(null==(a=e.status)?void 0:a.toLowerCase())==="pending"&&(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 w-full sm:w-auto",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(p.$,{variant:"full day"===C[e.id]?"default":"outline",size:"sm",onClick:()=>ee(e.id,"full day"),className:"text-xs",children:"Full Day"}),(0,s.jsx)(p.$,{variant:"half day"===C[e.id]?"default":"outline",size:"sm",onClick:()=>ee(e.id,"half day"),className:"text-xs",children:"Half Day"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(p.$,{size:"sm",onClick:()=>K(e.id,"approved"),className:"bg-green-600 hover:bg-green-700",children:[(0,s.jsx)(c.A,{className:"h-4 w-4 mr-1"}),"Approve"]}),(0,s.jsxs)(p.$,{size:"sm",variant:"destructive",onClick:()=>K(e.id,"rejected"),children:[(0,s.jsx)(n.A,{className:"h-4 w-4 mr-1"}),"Reject"]})]})]})]})]})})})},e.id)})})})})]})]})}},20063:(e,t,a)=>{"use strict";var s=a(47260);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})},26983:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},31856:(e,t,a)=>{"use strict";a.d(t,{CG:()=>d,Fm:()=>p,XW:()=>x,cj:()=>c,h:()=>f,qp:()=>g});var s=a(95155),r=a(12115),n=a(89511),l=a(83101),i=a(65229),o=a(25016);let c=n.bL,d=n.l9;n.bm;let u=n.ZL,m=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.hJ,{className:(0,o.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r,ref:t})});m.displayName=n.hJ.displayName;let h=(0,l.F)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),f=r.forwardRef((e,t)=>{let{side:a="right",className:r,children:l,...c}=e;return(0,s.jsxs)(u,{children:[(0,s.jsx)(m,{}),(0,s.jsxs)(n.UC,{ref:t,className:(0,o.cn)(h({side:a}),r),...c,children:[l,(0,s.jsxs)(n.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,s.jsx)(i.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=n.UC.displayName;let p=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};p.displayName="SheetHeader";let x=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};x.displayName="SheetFooter";let g=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.hE,{ref:t,className:(0,o.cn)("text-lg font-semibold text-foreground",a),...r})});g.displayName=n.hE.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.VY,{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",a),...r})}).displayName=n.VY.displayName},33789:(e,t,a)=>{"use strict";a.d(t,{p:()=>n});var s=a(95155);a(12115);var r=a(25016);function n(e){let{className:t,type:a,...n}=e;return(0,s.jsx)("input",{type:a,"data-slot":"input",className:(0,r.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...n})}},42529:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},47507:(e,t,a)=>{"use strict";a.d(t,{bq:()=>u,eb:()=>h,gC:()=>m,l6:()=>c,yv:()=>d});var s=a(95155);a(12115);var r=a(98229),n=a(24033),l=a(5917),i=a(12108),o=a(25016);function c(e){let{...t}=e;return(0,s.jsx)(r.bL,{"data-slot":"select",...t})}function d(e){let{...t}=e;return(0,s.jsx)(r.WT,{"data-slot":"select-value",...t})}function u(e){let{className:t,size:a="default",children:l,...i}=e;return(0,s.jsxs)(r.l9,{"data-slot":"select-trigger","data-size":a,className:(0,o.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...i,children:[l,(0,s.jsx)(r.In,{asChild:!0,children:(0,s.jsx)(n.A,{className:"size-4 opacity-50"})})]})}function m(e){let{className:t,children:a,position:n="popper",...l}=e;return(0,s.jsx)(r.ZL,{children:(0,s.jsxs)(r.UC,{"data-slot":"select-content",className:(0,o.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...l,children:[(0,s.jsx)(f,{}),(0,s.jsx)(r.LM,{className:(0,o.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:a}),(0,s.jsx)(p,{})]})})}function h(e){let{className:t,children:a,...n}=e;return(0,s.jsxs)(r.q7,{"data-slot":"select-item",className:(0,o.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...n,children:[(0,s.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,s.jsx)(r.VF,{children:(0,s.jsx)(l.A,{className:"size-4"})})}),(0,s.jsx)(r.p4,{children:a})]})}function f(e){let{className:t,...a}=e;return(0,s.jsx)(r.PP,{"data-slot":"select-scroll-up-button",className:(0,o.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(i.A,{className:"size-4"})})}function p(e){let{className:t,...a}=e;return(0,s.jsx)(r.wn,{"data-slot":"select-scroll-down-button",className:(0,o.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,s.jsx)(n.A,{className:"size-4"})})}},56069:(e,t,a)=>{"use strict";a.d(t,{AuthProvider:()=>f,A:()=>p});var s=a(95155),r=a(12115);let n="https://api.gajkesaristeels.in",l="".concat(n,"/user/token"),i="".concat(n,"/user/logout"),o="".concat(n,"/user/manage/get"),c="".concat(n,"/user/manage/current-user"),d={getToken:()=>localStorage.getItem("authToken"),setToken:e=>{{localStorage.setItem("authToken",e);let t="localhost"===window.location.hostname?"authToken=".concat(e,"; path=/; max-age=86400; samesite=strict"):"authToken=".concat(e,"; path=/; max-age=86400; secure; samesite=strict");document.cookie=t}},removeToken:()=>{localStorage.removeItem("authToken"),localStorage.removeItem("userRole"),localStorage.removeItem("userData"),localStorage.removeItem("currentUser"),document.cookie="authToken=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT"},getAuthHeader:()=>{let e=d.getToken();return e?"Bearer ".concat(e):null},setUserRole:e=>{localStorage.setItem("userRole",e.roles),localStorage.setItem("userData",JSON.stringify(e))},getUserRole:()=>localStorage.getItem("userRole"),getUserData:()=>{{let e=localStorage.getItem("userData");return e?JSON.parse(e):null}},setCurrentUser:e=>{localStorage.setItem("currentUser",JSON.stringify(e))},getCurrentUser:()=>{{let e=localStorage.getItem("currentUser");return e?JSON.parse(e):null}}},u={login:async e=>{try{let t=await fetch(l,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e=await t.text();throw Error("Login failed: ".concat(t.status," ").concat(e))}let[a,s]=(await t.text()).split(" ");if(!s)throw Error("Invalid response format from server");d.setToken(s);try{console.log("Fetching role for username:",e.username),console.log("Token being used:",s);let t=await fetch("".concat(o,"?username=").concat(e.username),{credentials:"include",method:"GET",headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"}});if(t.ok){let e=await t.json();d.setUserRole(e),console.log("User role data stored:",e)}else{console.warn("Failed to fetch user role data:",t.status,t.statusText);let e=await t.text();console.warn("Error response:",e)}}catch(e){console.warn("Error fetching user role data:",e)}try{let e=await fetch(c,{credentials:"include",method:"GET",headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"}});if(e.ok){let t=await e.json();d.setCurrentUser(t),console.log("Current user data stored:",t)}else console.warn("Failed to fetch current user data:",e.status)}catch(e){console.warn("Error fetching current user data:",e)}return{token:s,role:a||"USER"}}catch(e){throw console.error("Login error:",e),e}},logout:async()=>{try{let e=d.getToken();if(!e)return void d.removeToken();let t=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});d.removeToken(),t.ok||console.warn("Logout request failed, but token was cleared locally")}catch(e){console.error("Logout error:",e),d.removeToken()}},getStoredToken:()=>d.getToken(),getUserRole:()=>d.getUserRole(),getUserData:()=>d.getUserData(),getCurrentUser:()=>d.getCurrentUser()};var m=a(20063);let h=(0,r.createContext)(void 0);function f(e){let{children:t}=e,[a,n]=(0,r.useState)(!1),[l,i]=(0,r.useState)(null),[o,c]=(0,r.useState)(!0),[d,f]=(0,r.useState)(null),[p,x]=(0,r.useState)(null),[g,v]=(0,r.useState)(null),j=(0,r.useRef)(null),y=(0,m.useRouter)(),w=e=>{if(!e)return null;let t=e.split(".");if(t.length<2)return null;try{let e=t[1].replace(/-/g,"+").replace(/_/g,"/");if("function"!=typeof atob)return null;let a=atob(e),s=JSON.parse(a);if("number"==typeof s.exp)return s.exp;return null}catch(e){return null}};(0,r.useEffect)(()=>{let e=u.getStoredToken(),t=u.getUserRole(),a=u.getUserData(),s=u.getCurrentUser();if(e){let r=w(e),l=Math.floor(Date.now()/1e3);r&&r<=l?u.logout().finally(()=>{i(null),n(!1),f(null),x(null),v(null),y.replace("/login")}):(i(e),n(!0),f(t),x(a),v(s))}c(!1)},[]);let b=async(e,t)=>{c(!0);try{let a=await u.login({username:e,password:t});i(a.token),n(!0);let s=u.getUserRole(),r=u.getUserData(),l=u.getCurrentUser();f(s),x(r),v(l)}catch(e){throw e}finally{c(!1)}},N=async()=>{try{await u.logout(),i(null),n(!1),f(null),x(null),v(null),y.replace("/login")}catch(e){throw i(null),n(!1),f(null),x(null),e}};return(0,r.useEffect)(()=>{if(j.current&&(clearTimeout(j.current),j.current=null),!l)return;let e=w(l);if(!e)return;let t=1e3*e-Date.now();return t<=0?void N():(j.current=setTimeout(()=>{N()},t),()=>{j.current&&(clearTimeout(j.current),j.current=null)})},[l]),(0,s.jsx)(h.Provider,{value:{isAuthenticated:a,token:l,login:b,logout:N,isLoading:o,userRole:d,userData:p,currentUser:g},children:t})}function p(){let e=(0,r.useContext)(h);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},66955:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]])},67812:(e,t,a)=>{"use strict";a.d(t,{E:()=>o});var s=a(95155);a(12115);var r=a(32467),n=a(83101),l=a(25016);let i=(0,n.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:a,asChild:n=!1,...o}=e,c=n?r.DX:"span";return(0,s.jsx)(c,{"data-slot":"badge",className:(0,l.cn)(i({variant:a}),t),...o})}},68122:(e,t,a)=>{"use strict";a.d(t,{E:()=>n});var s=a(95155),r=a(25016);function n(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"skeleton",className:(0,r.cn)("bg-accent animate-pulse rounded-md",t),...a})}},78858:(e,t,a)=>{Promise.resolve().then(a.bind(a,19324))},78874:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},86651:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])}},e=>{e.O(0,[9358,9,1052,1691,4806,9687,8441,1255,7358],()=>e(e.s=78858)),_N_E=e.O()}]);