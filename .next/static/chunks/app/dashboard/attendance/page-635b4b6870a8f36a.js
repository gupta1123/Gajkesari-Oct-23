(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6437],{25016:(e,t,s)=>{"use strict";s.d(t,{$:()=>o,V5:()=>m,cn:()=>d,hI:()=>x});var a=s(2821),n=s(75889),r=s(71163),l=s(26467),i=s(35504),c=s(92365);function d(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,n.QP)((0,a.$)(t))}function o(e){if(!e)return"";try{let[t,s]=e.split(":"),a=new Date;return a.setHours(parseInt(t,10),parseInt(s,10),0,0),(0,r.GP)(a,"h:mm a")}catch(t){return console.error("Error formatting time:",t),e}}function m(e){if(!e)return"";try{let t=(0,l.H)(e);if((0,i.c)(t))return"Today";if((0,c.P)(t))return"Yesterday";return(0,r.GP)(t,"dd MMM yyyy")}catch(t){return console.error("Error formatting date:",t),e}}function x(e){if(!e)return"";try{let t;if(e.includes("T"))t=(0,l.H)(e);else{let s=e.split(" ");if(s.length>=2){let e=s[0],a=s[1],[n,r,l]=e.split("-").map(Number),[i,c]=a.split(":").map(Number);t=new Date(n,r-1,l,i,c)}else t=(0,l.H)(e)}let s=m((0,r.GP)(t,"yyyy-MM-dd")),a=o((0,r.GP)(t,"HH:mm"));return"".concat(s," ").concat(a)}catch(t){return console.error("Error formatting last updated:",t),e}}},33884:(e,t,s)=>{"use strict";s.d(t,{BK:()=>i,eu:()=>l,q5:()=>c});var a=s(95155);s(12115);var n=s(46591),r=s(25016);function l(e){let{className:t,...s}=e;return(0,a.jsx)(n.bL,{"data-slot":"avatar",className:(0,r.cn)("relative flex size-8 shrink-0 overflow-hidden rounded-full",t),...s})}function i(e){let{className:t,...s}=e;return(0,a.jsx)(n._V,{"data-slot":"avatar-image",className:(0,r.cn)("aspect-square size-full",t),...s})}function c(e){let{className:t,...s}=e;return(0,a.jsx)(n.H4,{"data-slot":"avatar-fallback",className:(0,r.cn)("bg-muted flex size-full items-center justify-center rounded-full",t),...s})}},51631:(e,t,s)=>{"use strict";s.d(t,{Eb:()=>h,Iu:()=>m,M_:()=>f,WA:()=>p,cU:()=>x,dK:()=>o,n$:()=>u});var a=s(95155),n=s(12115),r=s(90368),l=s(27937),i=s(37772),c=s(25016),d=s(97003);let o=e=>{let{className:t,...s}=e;return(0,a.jsx)("nav",{role:"navigation","aria-label":"pagination",className:(0,c.cn)("mx-auto flex w-full justify-center",t),...s})};o.displayName="Pagination";let m=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("ul",{ref:t,className:(0,c.cn)("flex flex-row items-center gap-1",s),...n})});m.displayName="PaginationContent";let x=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("li",{ref:t,className:(0,c.cn)("",s),...n})});x.displayName="PaginationItem";let u=e=>{let{className:t,isActive:s,size:n="icon",...r}=e;return(0,a.jsx)("a",{"aria-current":s?"page":void 0,className:(0,c.cn)((0,d.r)({variant:s?"outline":"ghost",size:n}),t),...r})};u.displayName="PaginationLink";let h=e=>{let{className:t,...s}=e;return(0,a.jsxs)(u,{"aria-label":"Go to previous page",size:"default",className:(0,c.cn)("gap-1 pl-2.5",t),...s,children:[(0,a.jsx)(r.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Previous"})]})};h.displayName="PaginationPrevious";let p=e=>{let{className:t,...s}=e;return(0,a.jsxs)(u,{"aria-label":"Go to next page",size:"default",className:(0,c.cn)("gap-1 pr-2.5",t),...s,children:[(0,a.jsx)("span",{children:"Next"}),(0,a.jsx)(l.A,{className:"h-4 w-4"})]})};p.displayName="PaginationNext";let f=e=>{let{className:t,...s}=e;return(0,a.jsxs)("span",{"aria-hidden":!0,className:(0,c.cn)("flex h-9 w-9 items-center justify-center",t),...s,children:[(0,a.jsx)(i.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"More pages"})]})};f.displayName="PaginationEllipsis"},54679:(e,t,s)=>{"use strict";s.d(t,{Cf:()=>m,Es:()=>u,L3:()=>h,ZJ:()=>d,c7:()=>x,lG:()=>i,rr:()=>p,zM:()=>c});var a=s(95155);s(12115);var n=s(89511),r=s(65229),l=s(25016);function i(e){let{...t}=e;return(0,a.jsx)(n.bL,{"data-slot":"dialog",...t})}function c(e){let{...t}=e;return(0,a.jsx)(n.l9,{"data-slot":"dialog-trigger",...t})}function d(e){let{...t}=e;return(0,a.jsx)(n.ZL,{"data-slot":"dialog-portal",...t})}function o(e){let{className:t,...s}=e;return(0,a.jsx)(n.hJ,{"data-slot":"dialog-overlay",className:(0,l.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s})}function m(e){let{className:t,children:s,showCloseButton:i=!0,...c}=e;return(0,a.jsxs)(d,{"data-slot":"dialog-portal",children:[(0,a.jsx)(o,{}),(0,a.jsxs)(n.UC,{"data-slot":"dialog-content",className:(0,l.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...c,children:[s,i&&(0,a.jsxs)(n.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,a.jsx)(r.A,{}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function x(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-header",className:(0,l.cn)("flex flex-col gap-2 text-center sm:text-left",t),...s})}function u(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"dialog-footer",className:(0,l.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...s})}function h(e){let{className:t,...s}=e;return(0,a.jsx)(n.hE,{"data-slot":"dialog-title",className:(0,l.cn)("text-lg leading-none font-semibold",t),...s})}function p(e){let{className:t,...s}=e;return(0,a.jsx)(n.VY,{"data-slot":"dialog-description",className:(0,l.cn)("text-muted-foreground text-sm",t),...s})}},73344:(e,t,s)=>{"use strict";s.d(t,{DW:()=>i,DZ:()=>d,EY:()=>o,eu:()=>c});var a=s(95155),n=s(12115),r=s(83101),l=s(25016);let i=(0,r.F)("font-semibold tracking-tight text-foreground",{variants:{size:{xs:"text-xs",sm:"text-sm",md:"text-base",lg:"text-lg",xl:"text-xl","2xl":"text-2xl","3xl":"text-3xl","4xl":"text-4xl"},weight:{normal:"font-normal",medium:"font-medium",semibold:"font-semibold",bold:"font-bold"}},defaultVariants:{size:"lg",weight:"semibold"}}),c=(0,r.F)("text-foreground",{variants:{size:{xs:"text-xs",sm:"text-sm",md:"text-base",lg:"text-lg"},tone:{default:"text-foreground",muted:"text-muted-foreground",subtle:"text-muted-foreground/80"},weight:{normal:"font-normal",medium:"font-medium",semibold:"font-semibold"},tracking:{tight:"tracking-tight",normal:"tracking-normal",wide:"tracking-wide"}},defaultVariants:{size:"md",tone:"default",weight:"normal",tracking:"normal"}}),d=n.forwardRef((e,t)=>{let{className:s,size:n,weight:r,as:c="h2",...d}=e;return(0,a.jsx)(c,{ref:t,className:(0,l.cn)(i({size:n,weight:r}),s),...d})});d.displayName="Heading";let o=n.forwardRef((e,t)=>{let{className:s,size:n,tone:r,weight:i,tracking:d,as:o="p",...m}=e;return(0,a.jsx)(o,{ref:t,className:(0,l.cn)(c({size:n,tone:r,weight:i,tracking:d}),s),...m})});o.displayName="Text"},79101:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>T});var a=s(95155),n=s(12115),r=s(33789),l=s(47507),i=s(83209),c=s(67812),d=s(54679),o=s(59427),m=s(26327),x=s(78874),u=s(16485),h=s(71163),p=s(26467),f=s(73344);let g=e=>{switch(e){case"full day":return"Full Day";case"present":return"Present";case"half day":return"Half Day";case"absent":return"Absent";case"paid":return"Paid Leave";case"activity":return"Activity";default:return e.split(" ").filter(Boolean).map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}},j=e=>{let{month:t,year:s,attendanceData:r,onSummaryChange:l,onDateClick:i,employeeName:c}=e,d=(0,n.useRef)(null),o=(0,n.useRef)(l);return(0,n.useEffect)(()=>{o.current=l},[l]),(0,n.useEffect)(()=>{(()=>{if(d.current){d.current.innerHTML="";let e=new Date(s,t,1).getDay(),a=new Date(s,t+1,0).getDate(),n=0,l=0,m=0,x=e=>e.includes("T")?e.split("T")[0]:e;for(let t=0;t<e;t++){let e=document.createElement("div");e.classList.add("empty"),d.current.appendChild(e)}for(let e=1;e<=a;e++){let a=document.createElement("div");a.textContent=e.toString();let o="".concat(s,"-").concat(String(t+1).padStart(2,"0"),"-").concat(String(e).padStart(2,"0")),u=0===new Date(s,t,e).getDay(),h=r.find(e=>{let t=x(e.checkinDate)===o;return t&&console.log("Found attendance record for ".concat(o,":"),e),t}),p=null==h?void 0:h.attendanceStatus,f=document.createElement("span");if(f.classList.add("calendar-tooltip"),u)a.classList.add("paid"),f.textContent=g("paid"),f.style.setProperty("--tooltip-translate-x","-20%"),f.style.setProperty("--tooltip-arrow-left","35%"),n++;else if(p){let e=p.toLowerCase().trim(),t=e.replace(/\s+/g,"-");a.classList.add(t),f.textContent=g(e),"full day"===e||"present"===e?n++:"half day"===e?l++:"absent"===e&&m++}else a.classList.add("absent"),f.textContent=g("absent"),m++;a.appendChild(f),a.addEventListener("click",()=>{i(o,c)}),d.current.appendChild(a)}let u={fullDays:n,halfDays:l,absentDays:m};o.current(u)}})()},[t,s,r,c,i]),(0,a.jsxs)("div",{className:"custom-calendar",children:[(0,a.jsxs)("div",{className:"calendar-days",children:[(0,a.jsx)("div",{children:"S"}),(0,a.jsx)("div",{children:"M"}),(0,a.jsx)("div",{children:"T"}),(0,a.jsx)("div",{children:"W"}),(0,a.jsx)("div",{children:"T"}),(0,a.jsx)("div",{children:"F"}),(0,a.jsx)("div",{children:"S"})]}),(0,a.jsx)("div",{className:"calendar-dates",ref:d})]})};var v=s(33884);function y(e){var t,s;let{employee:r,selectedMonth:l,selectedYear:g,attendanceData:y,onDateClick:b}=e,[N,w]=(0,n.useState)(null),[k,D]=(0,n.useState)(!1),[S,C]=(0,n.useState)({fullDays:r.fullDays,halfDays:r.halfDays,absentDays:r.absent}),z=(0,n.useCallback)(e=>{if(b)return void b(e,r.name);r.attendance.find(t=>t.date===e)&&(w(e),D(!0))},[b,r.name,r.attendance]),A=(0,n.useCallback)(e=>{C(t=>t.fullDays===e.fullDays&&t.halfDays===e.halfDays&&t.absentDays===e.absentDays?t:e)},[]),E=(0,n.useMemo)(()=>y.filter(e=>e.employeeId===r.id),[y,r.id]),L=N&&(null==(t=r.attendance.find(e=>e.date===N))?void 0:t.visits)||[];return(0,n.useMemo)(()=>{let e=new Date(g,l,1),t=new Date(g,l+1,0),s=0,a=0,n=0,r=0;for(let l of E){let i=new Date(l.checkinDate);if(i<e||i>t)continue;let c=l.rawStatus,d=l.attendanceStatus;("full day"===d||"present"===d)&&r++,"Paid Leave"===c&&a++,"Activity"===c&&n++,0===i.getDay()&&("full day"===d||"present"===d)&&s++}return{sundays:s,paidLeaves:a,activities:n,fullDays:r}},[E,l,g]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i.Zp,{className:"w-full hover:shadow-md transition-shadow bg-card",children:[(0,a.jsx)(i.aR,{className:"pb-3",children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)(v.eu,{className:"h-10 w-10",children:[(0,a.jsx)(v.BK,{src:r.avatar,alt:r.name}),(0,a.jsx)(v.q5,{className:"bg-primary/10 text-primary font-semibold",children:(s=r.name)?s.trim().split(/\s+/).slice(0,2).map(e=>{var t,s;return null!=(s=null==(t=e[0])?void 0:t.toUpperCase())?s:""}).join(""):""})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(f.DZ,{as:"h3",size:"lg",weight:"semibold",className:"text-foreground dark:text-gray-200",children:r.name}),(0,a.jsx)(f.EY,{size:"sm",tone:"muted",className:"dark:text-gray-400",children:r.position})]})]})})}),(0,a.jsxs)(i.Wu,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2 mb-4",children:[(0,a.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/30 p-3 rounded-lg text-center w-full",children:[(0,a.jsx)("div",{className:"flex items-center justify-center mb-1",children:(0,a.jsx)(o.A,{className:"h-4 w-4 text-green-600 dark:text-green-400"})}),(0,a.jsx)(f.DZ,{as:"p",size:"lg",weight:"semibold",className:"text-green-800 dark:text-green-300",children:S.fullDays}),(0,a.jsx)(f.EY,{size:"xs",tone:"muted",className:"text-green-700 dark:text-green-400",children:"Full Days"}),"            "]}),(0,a.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/30 p-3 rounded-lg text-center",children:[(0,a.jsx)("div",{className:"flex items-center justify-center mb-1",children:(0,a.jsx)(m.A,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-400"})}),(0,a.jsx)(f.DZ,{as:"p",size:"lg",weight:"semibold",className:"text-yellow-800 dark:text-yellow-300",children:S.halfDays}),(0,a.jsx)(f.EY,{size:"xs",tone:"muted",className:"text-yellow-700 dark:text-yellow-400",children:"Half Days"})]}),(0,a.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/30 p-3 rounded-lg text-center",children:[(0,a.jsx)("div",{className:"flex items-center justify-center mb-1",children:(0,a.jsx)(x.A,{className:"h-4 w-4 text-red-600 dark:text-red-400"})}),(0,a.jsx)(f.DZ,{as:"p",size:"lg",weight:"semibold",className:"text-red-800 dark:text-red-300",children:S.absentDays}),(0,a.jsx)(f.EY,{size:"xs",tone:"muted",className:"text-red-700 dark:text-red-400",children:"Absent"})]})]}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(j,{month:l,year:g,attendanceData:E,onSummaryChange:A,onDateClick:z,employeeName:r.name})})]})]}),(0,a.jsx)(d.lG,{open:k,onOpenChange:D,children:(0,a.jsxs)(d.Cf,{className:"max-w-md",children:[(0,a.jsx)(d.c7,{children:(0,a.jsxs)(d.L3,{className:"flex items-center gap-2",children:[(0,a.jsx)(u.A,{className:"h-5 w-5"}),"Visits on ",N?(0,h.GP)((0,p.H)(N),"MMMM d, yyyy"):""]})}),(0,a.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:L.length>0?L.map(e=>(0,a.jsxs)("div",{className:"border rounded-lg p-3 dark:border-gray-700",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)(f.DZ,{as:"h4",size:"md",weight:"semibold",className:"dark:text-gray-200",children:e.customer}),(0,a.jsx)(c.E,{variant:"secondary",className:"dark:bg-gray-700 dark:text-gray-300",children:e.time})]}),(0,a.jsx)(f.EY,{size:"sm",tone:"muted",className:"mt-1 dark:text-gray-400",children:e.purpose})]},e.id)):(0,a.jsx)(f.EY,{size:"sm",tone:"muted",className:"py-4 text-center dark:text-gray-400",children:"No visits recorded for this day"})})]})})]})}var b=s(20063),N=s(97003),w=s(96633),k=s(19740),D=s(38581),S=s(89511),C=s(51631);let z=e=>e.checkinDate&&e.checkinTime&&e.checkoutDate&&e.checkoutTime?{emoji:"✅",status:"Completed",color:"bg-purple-100 text-purple-800"}:e.checkoutDate&&e.checkoutTime?{emoji:"⏱️",status:"Checked Out",color:"bg-orange-100 text-orange-800"}:e.checkinDate&&e.checkinTime?{emoji:"\uD83D\uDD70️",status:"On Going",color:"bg-green-100 text-green-800"}:{emoji:"\uD83D\uDCC5",status:"Assigned",color:"bg-blue-100 text-blue-800"},A=(e,t)=>{if(!e||!t)return"";let s=new Date("".concat(e,"T").concat(t)),a=s.toLocaleDateString("en-US",{month:"short"}),n=s.getDate(),r=s.getFullYear().toString().slice(-2),l=s.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0});return"".concat(a," ").concat(n," '").concat(r," ").concat(l)},E=e=>{let{isOpen:t,onClose:s,visitData:r,selectedDate:l,employeeName:i}=e,[c,o]=(0,n.useState)(null),[m,x]=(0,n.useState)(1),u=(0,b.useRouter)();(0,n.useEffect)(()=>{t&&(x(1),o(null))},[t,r]);let h=e=>{x(e)},p=7*m,f=r.slice(p-7,p);return(0,a.jsxs)(d.lG,{open:t,onOpenChange:s,children:[(0,a.jsxs)(d.ZJ,{children:[(0,a.jsx)(S.hJ,{className:"fixed inset-0 z-40 bg-black/60 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"}),(0,a.jsxs)(S.UC,{className:"bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 w-[90vw] sm:w-[85vw] lg:w-[75vw] max-w-[1200px] h-[80vh] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border shadow-2xl duration-200 flex flex-col",children:[(0,a.jsx)(d.c7,{className:"sr-only",children:(0,a.jsxs)(d.L3,{children:["Visits for ",i," on ",new Date(l).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})]})}),(0,a.jsx)("div",{className:"flex-shrink-0 px-6 pt-6",children:(0,a.jsx)("div",{className:"rounded-md bg-black text-white px-4 py-3",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-10 h-10 bg-blue-900/60 rounded-lg flex items-center justify-center",children:(0,a.jsx)(k.gc,{icon:D.BEE,className:"text-blue-300"})})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold text-white truncate",children:["Visits for ",i]}),(0,a.jsx)("p",{className:"text-sm text-gray-300",children:new Date(l).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),(0,a.jsxs)("div",{className:"flex-shrink-0 flex items-center space-x-3",children:[(0,a.jsxs)("p",{className:"text-sm font-medium text-blue-400",children:[r.length," ",1===r.length?"visit":"visits"]}),(0,a.jsxs)(N.$,{onClick:s,variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-white/80 hover:bg-white/10",children:[(0,a.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})})}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden px-4 py-4",children:(0,a.jsx)("div",{className:"h-[65vh] w-full overflow-x-auto overflow-y-auto border rounded-lg bg-background",children:(0,a.jsx)("div",{className:"min-w-full",children:f.length>0?(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(w.XI,{className:"w-full min-w-[1200px] table-fixed",children:[(0,a.jsx)(w.A0,{children:(0,a.jsxs)(w.Hj,{className:"bg-muted hover:bg-muted/80",children:[(0,a.jsx)(w.nd,{className:"font-semibold text-center px-3 py-4 text-sm w-[20%]",children:"Customer Name"}),(0,a.jsx)(w.nd,{className:"font-semibold text-center px-3 py-4 text-sm w-[15%]",children:"Executive"}),(0,a.jsx)(w.nd,{className:"font-semibold text-center px-3 py-4 text-sm w-[10%]",children:"Date"}),(0,a.jsx)(w.nd,{className:"font-semibold text-center px-3 py-4 text-sm w-[12%]",children:"Status"}),(0,a.jsx)(w.nd,{className:"font-semibold text-center px-3 py-4 text-sm w-[12%]",children:"Purpose"}),(0,a.jsx)(w.nd,{className:"font-semibold text-center px-3 py-4 text-sm w-[12%]",children:"Visit Start"}),(0,a.jsx)(w.nd,{className:"font-semibold text-center px-3 py-4 text-sm w-[12%]",children:"Visit End"}),(0,a.jsx)(w.nd,{className:"font-semibold text-center px-3 py-4 text-sm w-[8%]",children:"Intent"}),(0,a.jsx)(w.nd,{className:"font-semibold text-center px-3 py-4 text-sm w-[12%]",children:"Last Updated"}),(0,a.jsx)(w.nd,{className:"font-semibold text-center px-3 py-4 text-sm w-[10%]",children:"Actions"})]})}),(0,a.jsx)(w.BF,{children:f.map(e=>{let{emoji:t,status:n,color:r}=z(e);return(0,a.jsxs)(w.Hj,{className:"hover:bg-muted/40",children:[(0,a.jsx)(w.nA,{className:"text-center font-medium px-3 py-3 w-[20%] truncate",children:e.storeName||""}),(0,a.jsx)(w.nA,{className:"text-center px-3 py-3 w-[15%] truncate",children:i||""}),(0,a.jsx)(w.nA,{className:"text-center px-3 py-3 w-[10%]",children:new Date(l).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),(0,a.jsx)(w.nA,{className:"text-center px-3 py-3 w-[12%]",children:(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat(r),children:[(0,a.jsx)("span",{className:"mr-1",children:t}),n]})}),(0,a.jsx)(w.nA,{className:"text-center px-3 py-3 w-[12%] truncate",children:e.purpose||""}),(0,a.jsx)(w.nA,{className:"text-center px-3 py-3 w-[12%] truncate",children:A(e.checkinDate,e.checkinTime)||""}),(0,a.jsx)(w.nA,{className:"text-center px-3 py-3 w-[12%] truncate",children:A(e.checkoutDate,e.checkoutTime)||""}),(0,a.jsx)(w.nA,{className:"text-center font-medium px-3 py-3 w-[8%]",children:e.intent||""}),(0,a.jsx)(w.nA,{className:"text-center px-3 py-3 w-[12%] truncate",children:A(e.updatedAt,e.updatedTime)||""}),(0,a.jsx)(w.nA,{className:"text-center px-3 py-3 w-[10%]",children:(0,a.jsxs)(N.$,{size:"sm",variant:"outline",onClick:()=>{var t;return t=e.id,void(u.push("/dashboard/visits/".concat(t)),s())},children:[(0,a.jsx)(k.gc,{icon:D.pS3,className:"mr-1 h-3 w-3"}),"View"]})})]},e.id)})})]})}):(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsxs)("p",{className:"text-lg font-semibold text-red-400 flex items-center justify-center space-x-2",children:[(0,a.jsx)(k.gc,{icon:D.zpE,className:"text-red-400"}),(0,a.jsx)("span",{children:"No visits on this day"})]})})})})}),(0,a.jsx)(d.Es,{className:"pt-4 border-t",children:(0,a.jsxs)("div",{className:"w-full flex items-center justify-end gap-3",children:[f.length>0&&r.length>7&&(0,a.jsx)(C.dK,{children:(0,a.jsxs)(C.Iu,{children:[m>1&&(0,a.jsx)(C.Eb,{size:"sm",onClick:()=>h(m-1)}),(()=>{let e=Math.ceil(r.length/7),t=[];if(e<=7)for(let s=1;s<=e;s++)t.push((0,a.jsx)(C.cU,{children:(0,a.jsx)(C.n$,{size:"sm",isActive:s===m,onClick:()=>h(s),children:s})},s));else if(m<=4){for(let e=1;e<=5;e++)t.push((0,a.jsx)(C.cU,{children:(0,a.jsx)(C.n$,{size:"sm",isActive:e===m,onClick:()=>h(e),children:e})},e));t.push((0,a.jsx)(C.M_,{},"e1")),t.push((0,a.jsx)(C.cU,{children:(0,a.jsx)(C.n$,{size:"sm",onClick:()=>h(e),children:e})},e))}else if(m>=Math.ceil(r.length/7)-3){t.push((0,a.jsx)(C.cU,{children:(0,a.jsx)(C.n$,{size:"sm",onClick:()=>h(1),children:"1"})},1)),t.push((0,a.jsx)(C.M_,{},"e2"));for(let s=e-4;s<=e;s++)t.push((0,a.jsx)(C.cU,{children:(0,a.jsx)(C.n$,{size:"sm",isActive:s===m,onClick:()=>h(s),children:s})},s))}else{t.push((0,a.jsx)(C.cU,{children:(0,a.jsx)(C.n$,{size:"sm",onClick:()=>h(1),children:"1"})},1)),t.push((0,a.jsx)(C.M_,{},"e3"));for(let e=m-1;e<=m+1;e++)t.push((0,a.jsx)(C.cU,{children:(0,a.jsx)(C.n$,{size:"sm",isActive:e===m,onClick:()=>h(e),children:e})},e));t.push((0,a.jsx)(C.M_,{},"e4")),t.push((0,a.jsx)(C.cU,{children:(0,a.jsx)(C.n$,{size:"sm",onClick:()=>h(e),children:e})},e))}return t})(),m<Math.ceil(r.length/7)&&(0,a.jsx)(C.WA,{size:"sm",onClick:()=>h(m+1)})]})}),(0,a.jsx)(N.$,{onClick:s,children:"Close"})]})})]})]}),c&&(0,a.jsx)(d.lG,{open:!!c,onOpenChange:()=>o(null),children:(0,a.jsx)(d.ZJ,{children:(0,a.jsxs)(S.UC,{className:"bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200",children:[(0,a.jsx)(d.c7,{children:(0,a.jsxs)(d.L3,{children:["Visit Details for ",c.storeName||"Unknown Store"]})}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold",children:"Customer Name:"}),(0,a.jsx)("p",{children:c.storeName||""})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold",children:"Executive:"}),(0,a.jsx)("p",{children:i||""})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold",children:"Date:"}),(0,a.jsx)("p",{children:A(c.visit_date||"","")||""})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold",children:"Status:"}),(0,a.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-md text-sm font-medium ".concat(z(c).color),children:[z(c).emoji," ",z(c).status]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold",children:"Purpose:"}),(0,a.jsx)("p",{children:c.purpose||""})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold",children:"Visit Start:"}),(0,a.jsx)("p",{children:A(c.checkinDate||"",c.checkinTime||"")||""})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold",children:"Visit End:"}),(0,a.jsx)("p",{children:A(c.checkoutDate||"",c.checkoutTime||"")||""})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold",children:"Intent:"}),(0,a.jsx)("p",{children:c.intent||""})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold",children:"Last Updated:"}),(0,a.jsx)("p",{children:A(c.updatedAt||"",c.updatedTime||"")||""})]})]}),(0,a.jsx)(d.Es,{children:(0,a.jsx)(N.$,{onClick:()=>o(null),children:"Close"})})]})})})]})};var L=s(13626);let M=Array.from({length:27},(e,t)=>2024+t),P=["January","February","March","April","May","June","July","August","September","October","November","December"];function T(){let[e,t]=(0,n.useState)([]),[s,i]=(0,n.useState)([]),[c,d]=(0,n.useState)(new Date().getFullYear()),[o,m]=(0,n.useState)(new Date().getMonth()),[x,u]=(0,n.useState)(""),[h,p]=(0,n.useState)(""),[f,g]=(0,n.useState)(!0),[j,v]=(0,n.useState)(!1),[b,N]=(0,n.useState)([]),[w,k]=(0,n.useState)(""),[D,S]=(0,n.useState)(""),C=(0,n.useMemo)(()=>M.map(e=>({value:String(e),label:String(e)})),[]),z="attendance.page.state.v1",A=(0,n.useRef)(!1),[T,I]=(0,n.useState)(!1);(0,n.useEffect)(()=>{if(!A.current){try{let e=sessionStorage.getItem(z);if(e){let t=JSON.parse(e);"number"==typeof t.selectedYear&&d(t.selectedYear),"number"==typeof t.selectedMonth&&m(t.selectedMonth),"string"==typeof t.nameFilter&&p(t.nameFilter)}}catch(e){}A.current=!0,I(!0)}},[]),(0,n.useEffect)(()=>{if(A.current)try{sessionStorage.setItem(z,JSON.stringify({selectedYear:c,selectedMonth:o,nameFilter:h}))}catch(e){}},[c,o,h]);let U=localStorage.getItem("authToken"),F=(0,n.useCallback)(async()=>{if(!U)return void console.error("Auth token is missing");try{let e=await fetch("https://api.gajkesaristeels.in/employee/getAll",{headers:{Authorization:"Bearer ".concat(U)}});if(!e.ok)throw Error("Failed to fetch employees");let t=await e.json();i(t)}catch(e){console.error("Error fetching employees:",e)}},[U]),_=(0,n.useCallback)(async()=>{if(g(!0),!U)return void console.error("Auth token is missing");let e=new Date(c,o,1).toISOString().split("T")[0],s=new Date(c,o+1,0),a=new Date(s);a.setDate(s.getDate()+1);let n=a.toISOString().split("T")[0];try{let s=await fetch("https://api.gajkesaristeels.in/attendance-log/getForRange1?start=".concat(e,"&end=").concat(n),{headers:{Authorization:"Bearer ".concat(U)}});if(!s.ok)throw Error("Failed to fetch attendance data");let a=await s.json(),r=a.map(e=>{let t="string"==typeof e.attendanceStatus?e.attendanceStatus:"",s=t.trim().toLowerCase(),a=t;return"present"===s?a="present":"full day"===s?a="full day":"absent"===s?a="absent":"half day"===s?a="half day":"paid leave"===s?a="paid":"activity"===s&&(a="activity"),{...e,attendanceStatus:a,rawStatus:t}});t(r),u(""),0===a.length&&u("No data available for the selected month and year. Please choose a different month or year.")}catch(e){console.error("Error fetching attendance data:",e),t([]),u("No data available for the selected month and year. Please choose a different month or year.")}g(!1)},[U,c,o]),V=(0,n.useCallback)(async(e,t)=>{if(!U)return void console.error("Auth token is missing");try{var s;let a="https://api.gajkesaristeels.in/visit/getByDateSorted?startDate=".concat(e,"&endDate=").concat(e,"&employeeName=").concat(t,"&page=0&size=100&sort=id,desc");console.log("Making API request to:",a),console.log("Request params:",{date:e,employeeName:t,token:U?"Present":"Missing"});let n=await fetch(a,{headers:{Authorization:"Bearer ".concat(U)}});if(!n.ok)throw Error("Failed to fetch visit data");let r=await n.json();console.log("Visit API Response:",{date:e,employeeName:t,totalElements:r.totalElements,contentLength:null==(s=r.content)?void 0:s.length,content:r.content}),N(r.content||[]),k(e),S(t),v(!0),0===r.content.length&&N([])}catch(e){console.error("Error fetching visit data:",e),N([])}},[U]);(0,n.useEffect)(()=>{T&&(_(),F())},[T,c,o,U,_,F]);let $=s.filter(e=>"".concat(e.firstName," ").concat(e.lastName).toLowerCase().includes(h.toLowerCase())).sort((e,t)=>{let s="".concat(e.firstName," ").concat(e.lastName).toLowerCase(),a="".concat(t.firstName," ").concat(t.lastName).toLowerCase();return s.localeCompare(a)});return(0,a.jsxs)("div",{className:"container mx-auto py-8 px-4 sm:px-8",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-4 sm:space-y-0 sm:space-x-4",children:[(0,a.jsx)("div",{className:"w-full sm:w-auto",children:(0,a.jsx)(L.Z,{options:C,value:String(c),onSelect:e=>{if(!e)return;let t=parseInt(e.value);Number.isNaN(t)||d(t)},placeholder:"Select a year",triggerClassName:"w-[180px]",contentClassName:"w-[var(--radix-popover-trigger-width)]",searchPlaceholder:"Search year..."})}),(0,a.jsx)("div",{children:(0,a.jsxs)(l.l6,{value:o.toString(),onValueChange:e=>m(parseInt(e)),children:[(0,a.jsx)(l.bq,{className:"w-[180px]",children:(0,a.jsx)(l.yv,{placeholder:"Select a month"})}),(0,a.jsx)(l.gC,{children:P.map((e,t)=>(0,a.jsx)(l.eb,{value:t.toString(),children:e},e))})]})}),(0,a.jsx)("div",{children:(0,a.jsx)(r.p,{type:"text",placeholder:"Filter by name",value:h,onChange:e=>p(e.target.value)})})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("p",{className:"text-lg font-bold text-foreground",children:"Legend:"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"inline-block w-3.5 h-3.5 rounded-sm bg-green-500 dark:bg-green-400 mr-2"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Full Day"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"inline-block w-3.5 h-3.5 rounded-sm bg-blue-500 dark:bg-blue-400 mr-2"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Present"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"inline-block w-3.5 h-3.5 rounded-sm bg-yellow-500 dark:bg-yellow-400 mr-2"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Half Day"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"inline-block w-3.5 h-3.5 rounded-sm bg-purple-200 border border-purple-400 dark:bg-purple-900/40 dark:border-purple-500 mr-2"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Paid Leave"})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"inline-block w-3.5 h-3.5 rounded-sm bg-red-500 dark:bg-red-400 mr-2"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Absent"})]})]})]})]}),x&&(0,a.jsx)("p",{className:"mb-4 text-red-500",children:x}),(0,a.jsx)("div",{className:"space-y-4",children:f?Array.from({length:5}).map((e,t)=>(0,a.jsx)("div",{className:"h-48 bg-gray-200 animate-pulse rounded-lg"},t)):(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:$.map(t=>{let s=e.filter(e=>e.employeeId===t.id),n=s.map(e=>new Date(e.checkinDate).getDate());return console.log("Dates passed to AttendanceCard for ".concat(t.firstName," ").concat(t.lastName,":"),n),(0,a.jsx)(y,{employee:{id:t.id,name:"".concat(t.firstName," ").concat(t.lastName),position:t.position,avatar:"",fullDays:0,halfDays:0,absent:0,attendance:s.map(e=>({date:e.checkinDate,status:"full day"===e.attendanceStatus?"present":"half day"===e.attendanceStatus?"half":"absent",visits:[]}))},selectedMonth:o,selectedYear:c,attendanceData:s.map(e=>({id:e.id,employeeId:e.employeeId,employeeName:e.employeeName,attendanceStatus:"Absent"===e.attendanceStatus?"absent":e.attendanceStatus,checkinDate:e.checkinDate,checkoutDate:e.checkoutDate,rawStatus:String(e.rawStatus||"")})),onDateClick:(e,t)=>V(e,t)},t.id)})})}),(0,a.jsx)(E,{isOpen:j,onClose:()=>v(!1),visitData:b,selectedDate:w,employeeName:D})]})}},83209:(e,t,s)=>{"use strict";s.d(t,{BT:()=>d,Wu:()=>o,ZB:()=>c,Zp:()=>l,aR:()=>i});var a=s(95155);s(12115);var n=s(25016),r=s(73344);function l(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,n.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...s})}function i(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,n.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...s})}function c(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,n.cn)((0,r.DW)({size:"md"}),"leading-none",t),...s})}function d(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,n.cn)((0,r.eu)({size:"sm",tone:"muted"}),t),...s})}function o(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,n.cn)("px-6",t),...s})}},91375:(e,t,s)=>{Promise.resolve().then(s.bind(s,79101))},97003:(e,t,s)=>{"use strict";s.d(t,{$:()=>c,r:()=>i});var a=s(95155);s(12115);var n=s(32467),r=s(83101),l=s(25016);let i=(0,r.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function c(e){let{className:t,variant:s,size:r,asChild:c=!1,...d}=e,o=c?n.DX:"button";return(0,a.jsx)(o,{"data-slot":"button",className:(0,l.cn)(i({variant:s,size:r,className:t})),...d})}}},e=>{e.O(0,[2266,9358,9,1052,1691,2632,8122,5941,8441,1255,7358],()=>e(e.s=91375)),_N_E=e.O()}]);