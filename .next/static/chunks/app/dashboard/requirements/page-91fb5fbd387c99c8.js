(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6706],{31856:(e,s,t)=>{"use strict";t.d(s,{CG:()=>c,Fm:()=>p,XW:()=>g,cj:()=>o,h:()=>x,qp:()=>j});var a=t(95155),l=t(12115),r=t(89511),i=t(83101),n=t(65229),d=t(25016);let o=r.bL,c=r.l9;r.bm;let m=r.ZL,h=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.hJ,{className:(0,d.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...l,ref:s})});h.displayName=r.hJ.displayName;let u=(0,i.F)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),x=l.forwardRef((e,s)=>{let{side:t="right",className:l,children:i,...o}=e;return(0,a.jsxs)(m,{children:[(0,a.jsx)(h,{}),(0,a.jsxs)(r.UC,{ref:s,className:(0,d.cn)(u({side:t}),l),...o,children:[i,(0,a.jsxs)(r.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,a.jsx)(n.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});x.displayName=r.UC.displayName;let p=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,d.cn)("flex flex-col space-y-2 text-center sm:text-left",s),...t})};p.displayName="SheetHeader";let g=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,d.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};g.displayName="SheetFooter";let j=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.hE,{ref:s,className:(0,d.cn)("text-lg font-semibold text-foreground",t),...l})});j.displayName=r.hE.displayName,l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.VY,{ref:s,className:(0,d.cn)("text-sm text-muted-foreground",t),...l})}).displayName=r.VY.displayName},69250:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>G});var a=t(95155),l=t(12115),r=t(71163),i=t(20063),n=t(56069),d=t(37621),o=t(1733),c=t(61927),m=t.n(c),h=t(63270),u=t.n(h),x=t(97003),p=t(67812),g=t(33789),j=t(90235),f=t(47507),y=t(98432),N=t(60028),v=t(54679),w=t(97450),b=t(90923),D=t(83209),k=t(7220),S=t(31856),C=t(26983),A=t(42348),T=t(42529),I=t(52056),P=t(46826),M=t(66955),E=t(16485),F=t(37772),q=t(71871),R=t(20508),O=t(71360),J=t(30814),B=t(90368),L=t(27937);let G=()=>{let[e,s]=(0,l.useState)([]),[t,c]=(0,l.useState)([]),[h,G]=(0,l.useState)({id:0,taskTitle:"",taskDesciption:"",dueDate:"",assignedToId:0,assignedToName:"",assignedById:86,status:"Assigned",priority:"low",category:"Requirement",storeId:0,storeName:"",storeCity:"",taskType:"requirement"}),$=(0,i.useRouter)(),z="requirements.filters.v1",[V,U]=(0,l.useState)(!1),[W,_]=(0,l.useState)("general"),[H,X]=(0,l.useState)(!1),[Y,Z]=(0,l.useState)(!1),[Q,K]=(0,l.useState)(!1),[ee,es]=(0,l.useState)(!1),[et,ea]=(0,l.useState)(!1),[el,er]=(0,l.useState)(!1),[ei,en]=(0,l.useState)(0),[ed,eo]=(0,l.useState)(10),[ec,em]=(0,l.useState)(0),[eh,eu]=(0,l.useState)(0),[ex,ep]=(0,l.useState)({employee:"",priority:"",status:"",search:"",startDate:(0,r.GP)(new Date,"yyyy-MM-dd"),endDate:(0,r.GP)(new Date,"yyyy-MM-dd")}),[eg,ej]=(0,l.useState)(!0),[ef,ey]=(0,l.useState)([]),[eN,ev]=(0,l.useState)([]),[ew,eb]=(0,l.useState)([]),[eD,ek]=(0,l.useState)(null),[eS,eC]=(0,l.useState)(null),[eA,eT]=(0,l.useState)(!1),[eI,eP]=(0,l.useState)(null),[eM,eE]=(0,l.useState)(!1),[eF,eq]=(0,l.useState)(""),[eR,eO]=(0,l.useState)(null),[eJ,eB]=(0,l.useState)(null),[eL,eG]=(0,l.useState)(!1),[e$,ez]=(0,l.useState)([]),[eV,eU]=(0,l.useState)(!1),[eW,e_]=(0,l.useState)(!1),[eH,eX]=(0,l.useState)(!1),[eY,eZ]=(0,l.useState)([]),[eQ,eK]=(0,l.useState)([]),[e0,e2]=(0,l.useState)([]),[e4,e1]=(0,l.useState)([]),{token:e6,userRole:e5,userData:e3,currentUser:e8}=(0,n.A)();(0,l.useEffect)(()=>{(()=>{var e;eG(!!("MANAGER"===e5||(null==e8||null==(e=e8.authorities)?void 0:e.some(e=>"ROLE_MANAGER"===e.authority))))})()},[e5,e8]),(0,l.useEffect)(()=>{let e=async()=>{if(eL&&(null==e3?void 0:e3.employeeId))try{console.log("Loading team data for manager with employeeId:",e3.employeeId);let e=await d.n.getTeamByEmployee(e3.employeeId);if(e&&e.length>0){let s=e[0],t=s.id;eB(t),console.log("Team ID loaded:",t);let a=s.fieldOfficers.map(e=>e.id);console.log("Team member IDs:",a);let l=ef.filter(e=>a.includes(e.id));ez(l),console.log("Team members loaded:",l.length)}else console.warn("No team data found for manager"),ek("No team data found for this manager")}catch(e){console.error("Failed to load team data:",e),ek("Failed to load team data")}};eL&&(null==e3?void 0:e3.employeeId)&&ef.length>0&&e()},[eL,null==e3?void 0:e3.employeeId,ef]),(0,l.useEffect)(()=>{if(eD){let e=setTimeout(()=>{ek(null)},2e4);return()=>clearTimeout(e)}},[eD]);let e7=e=>{if(!e)return"";let s=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return"".concat(s,"-").concat(t,"-").concat(a)},e9=(e,s)=>{ep({...ex,[e]:s})},se=(0,l.useCallback)(async()=>{if(e6){if(eL&&!eJ)return void console.log("⏳ Manager detected but no teamId yet - waiting for team data");console.log("Fetching tasks with:",{userRole:e5,userData:e3,isManager:eL,teamId:eJ,token:e6?"present":"missing"}),ej(!0);try{let e;if(eL&&eJ)e="https://api.gajkesaristeels.in/task/getByTeam?id=".concat(eJ),console.log("Using MANAGER API:",e,"Team ID:",eJ);else{let s=(0,r.GP)(new Date(ex.startDate),"yyyy-MM-dd"),t=(0,r.GP)(new Date(ex.endDate),"yyyy-MM-dd");e="https://api.gajkesaristeels.in/task/getByDate?start=".concat(s,"&end=").concat(t),console.log("Using ADMIN API:",e,"User Role:",e5)}let t=await fetch(e,{headers:{Authorization:"Bearer ".concat(e6)}});if(!t.ok){let e=await t.text();throw console.error("API Error:",t.status,e),Error("API request failed: ".concat(t.status," ").concat(e))}let a=await t.json();console.log("API Response:",a);let l=(Array.isArray(a)?a:[]).filter(e=>"requirement"===e.taskType).map(e=>({id:Number(e.id)||0,taskTitle:String(e.taskTitle||""),taskDesciption:String(e.taskDesciption||e.taskDescription||""),dueDate:String(e.dueDate||""),assignedToId:Number(e.assignedToId)||0,assignedToName:String(e.assignedToName||"Unknown"),assignedById:Number(e.assignedById)||0,status:String(e.status||""),priority:String(e.priority||""),category:String(e.category||""),storeId:Number(e.storeId)||0,storeName:String(e.storeName||""),storeCity:String(e.storeCity||""),taskType:String(e.taskType||"")})).sort((e,s)=>new Date(s.dueDate).getTime()-new Date(e.dueDate).getTime()),i=ei*ed,n=i+ed,d=l.slice(i,n);s(d),em(Math.ceil(l.length/ed)),eu(l.length),ej(!1)}catch(e){console.error("Error fetching tasks:",e),ej(!1)}}},[ex,e6,e5,e3,eL,eJ,ei,ed]),ss=(0,l.useCallback)(async()=>{if(e6)try{let e=await fetch("https://api.gajkesaristeels.in/employee/getAll",{headers:{Authorization:"Bearer ".concat(e6)}}),s=await e.json(),t=m()(s,e=>"".concat(e.firstName," ").concat(e.lastName));ey(t)}catch(e){console.error("Error fetching employees:",e)}},[e6]),st=(0,l.useCallback)(async()=>{if(e6){e_(!0);try{let e=await fetch("https://api.gajkesaristeels.in/store/names",{headers:{Authorization:"Bearer ".concat(e6)}}),s=await e.json();eb(s)}catch(e){console.error("Error fetching stores:",e)}finally{e_(!1)}}},[e6]);(0,l.useEffect)(()=>{try{let e=sessionStorage.getItem(z);if(e){let s=JSON.parse(e);(null==s?void 0:s.filters)&&ep(e=>({...e,...s.filters})),"number"==typeof(null==s?void 0:s.currentPage)&&en(s.currentPage),"number"==typeof(null==s?void 0:s.pageSize)&&eo(s.pageSize)}}catch(e){}U(!0)},[]),(0,l.useEffect)(()=>{if(V)try{sessionStorage.setItem(z,JSON.stringify({filters:ex,currentPage:ei,pageSize:ed}))}catch(e){}},[ex,ei,ed,V]),(0,l.useEffect)(()=>{V&&se()},[se,eJ,V]),(0,l.useEffect)(()=>{en(0)},[ex]),(0,l.useEffect)(()=>{ss()},[ss]);let sa=eL&&e$.length>0?e$:ef;(0,l.useEffect)(()=>{H&&st()},[H,st]),(0,l.useEffect)(()=>{if(e.length>0){let s=u()(e.map(e=>({id:e.assignedToId,name:e.assignedToName})),"id");ev(m()(s,"name"))}},[e]),(0,l.useEffect)(()=>{sl()},[e,ex]),(0,l.useEffect)(()=>{e2((eL&&e$.length>0?e$:ef).map(e=>({value:e.id.toString(),label:"".concat(e.firstName," ").concat(e.lastName)})).sort((e,s)=>e.label.localeCompare(s.label)))},[ef,e$,eL]),(0,l.useEffect)(()=>{e1(ew.map(e=>({value:e.id.toString(),label:e.storeName})).sort((e,s)=>e.label.localeCompare(s.label)))},[ew]);let sl=()=>{let s=ex.search.toLowerCase();c(e.filter(e=>{var t,a,l,r;return"requirement"===e.taskType&&(((null==(t=e.taskTitle)?void 0:t.toLowerCase())||"").includes(s)||((null==(a=e.taskDesciption)?void 0:a.toLowerCase())||"").includes(s)||((null==(l=e.storeName)?void 0:l.toLowerCase())||"").includes(s)||((null==(r=e.assignedToName)?void 0:r.toLowerCase())||"").includes(s))&&(""===ex.employee||"all"===ex.employee||e.assignedToId===parseInt(ex.employee))&&(""===ex.priority||"all"===ex.priority||e.priority===ex.priority)&&(""===ex.status||"all"===ex.status?"Complete"!==e.status:e.status===ex.status)&&(!!eL||(""===ex.startDate||new Date(e.dueDate)>=new Date(ex.startDate))&&(""===ex.endDate||new Date(e.dueDate)<=new Date(ex.endDate)))}))},sr=async()=>{if(e6){eX(!0);try{var e,t,a;let l={...h,taskDesciption:h.taskDesciption,taskType:"requirement"},r=await fetch("https://api.gajkesaristeels.in/task/create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e6)},body:JSON.stringify(l)}),i=await r.json(),n={...h,id:i.id,assignedToName:(null==(e=sa.find(e=>e.id===h.assignedToId))?void 0:e.firstName)+" "+(null==(t=sa.find(e=>e.id===h.assignedToId))?void 0:t.lastName)||"Unknown",storeName:(null==(a=ew.find(e=>e.id===h.storeId))?void 0:a.storeName)||""};s(e=>[n,...e]),X(!1),sc()}catch(e){console.error("Error creating task:",e)}finally{eX(!1)}}},si=()=>{eE(!1),eO(null),eq(""),eP(null)},sn=async()=>{if(e6&&null!==eR){if(eI&&eF===eI.status)return void si();try{(await fetch("https://api.gajkesaristeels.in/task/updateTask?taskId=".concat(eR),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e6)},body:JSON.stringify({status:eF})})).ok?(s(e=>e.map(e=>e.id===eR?{...e,status:eF}:e)),si()):console.error("Failed to update task status")}catch(e){console.error("Error updating task status:",e)}}},sd=async e=>{if(e6)try{await fetch("https://api.gajkesaristeels.in/task/deleteById?taskId=".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e6)}}),se()}catch(e){console.error("Error deleting task:",e)}},so=(e,s)=>{ep(t=>({...t,[e]:s})),sl()},sc=()=>{G({id:0,taskTitle:"",taskDesciption:"",dueDate:"",assignedToId:0,assignedToName:"",assignedById:86,status:"Assigned",priority:"low",category:"Requirement",storeId:0,storeName:"",storeCity:"",taskType:"requirement"}),eZ([]),eK([]),eb([]),_("general")},sm=e=>{switch(e.toLowerCase()){case"assigned":return{icon:(0,a.jsx)(C.A,{className:"w-4 h-4"}),color:"bg-purple-100 text-purple-800"};case"work in progress":return{icon:(0,a.jsx)(A.A,{className:"w-4 h-4 animate-spin"}),color:"bg-blue-100 text-blue-800"};case"complete":return{icon:(0,a.jsx)(T.A,{className:"w-4 h-4"}),color:"bg-green-100 text-green-800"};default:return{icon:(0,a.jsx)(I.A,{className:"w-4 h-4"}),color:"bg-gray-100 text-gray-800"}}};return(0,a.jsxs)("div",{className:"container mx-auto py-6 px-4 sm:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"mb-6 flex flex-wrap gap-4 items-center",children:[(0,a.jsxs)("div",{className:"flex-grow lg:flex-grow-0 lg:w-64 flex items-center gap-2",children:[(0,a.jsx)(g.p,{placeholder:"Search requirements",value:ex.search,onChange:e=>so("search",e.target.value),className:"w-full"}),(0,a.jsxs)(x.$,{onClick:()=>X(!0),children:[(0,a.jsx)(P.A,{className:"w-4 h-4 mr-2"})," New"]})]}),(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsxs)(x.$,{variant:"outline",size:"sm",className:"lg:hidden",onClick:()=>eT(!0),children:[(0,a.jsx)(M.A,{className:"w-4 h-4 mr-2"}),"Filters"]})}),(0,a.jsxs)("div",{className:"hidden lg:flex flex-wrap gap-4 items-center",children:[(0,a.jsxs)(f.l6,{value:ex.employee,onValueChange:e=>so("employee",e),children:[(0,a.jsx)(f.bq,{className:"w-[200px]",children:(0,a.jsx)(f.yv,{placeholder:"Filter by employee"})}),(0,a.jsxs)(f.gC,{children:[(0,a.jsx)(f.eb,{value:"all",children:"All Employees"}),eN.map(e=>(0,a.jsx)(f.eb,{value:e.id.toString(),children:e.name},e.id))]})]}),(0,a.jsxs)(f.l6,{value:ex.priority,onValueChange:e=>so("priority",e),children:[(0,a.jsx)(f.bq,{className:"w-[200px]",children:(0,a.jsx)(f.yv,{placeholder:"Filter by priority"})}),(0,a.jsxs)(f.gC,{children:[(0,a.jsx)(f.eb,{value:"all",children:"All Priorities"}),(0,a.jsx)(f.eb,{value:"low",children:"Low"}),(0,a.jsx)(f.eb,{value:"medium",children:"Medium"}),(0,a.jsx)(f.eb,{value:"high",children:"High"})]})]}),(0,a.jsxs)(f.l6,{value:ex.status,onValueChange:e=>so("status",e),children:[(0,a.jsx)(f.bq,{className:"w-[200px]",children:(0,a.jsx)(f.yv,{placeholder:"Filter by status"})}),(0,a.jsxs)(f.gC,{children:[(0,a.jsx)(f.eb,{value:"all",children:"All Open Statuses"}),(0,a.jsx)(f.eb,{value:"Assigned",children:"Assigned"}),(0,a.jsx)(f.eb,{value:"Work In Progress",children:"Work In Progress"}),(0,a.jsx)(f.eb,{value:"Complete",children:"Complete"})]})]}),!eL&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(j.J,{htmlFor:"startDate",children:"From:"}),(0,a.jsxs)(w.AM,{modal:!1,open:Q,onOpenChange:K,children:[(0,a.jsx)(w.Wv,{asChild:!0,children:(0,a.jsxs)(x.$,{variant:"outline",className:"w-[140px] justify-start text-left font-normal ".concat(!ex.startDate&&"text-muted-foreground"),children:[(0,a.jsx)(E.A,{className:"mr-2 h-4 w-4"}),ex.startDate?(0,r.GP)(new Date(ex.startDate),"MMM d, yyyy"):(0,a.jsx)("span",{children:"Pick start date"})]})}),(0,a.jsx)(w.hl,{className:"w-auto p-0",align:"start",side:"bottom",onInteractOutside:e=>e.preventDefault(),onPointerDownOutside:e=>e.preventDefault(),children:(0,a.jsx)(N.R,{mode:"single",selected:ex.startDate?new Date(ex.startDate):void 0,onSelect:e=>{e9("startDate",e7(e)),K(!1)},initialFocus:!0})})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(j.J,{htmlFor:"endDate",children:"To:"}),(0,a.jsxs)(w.AM,{modal:!1,open:ee,onOpenChange:es,children:[(0,a.jsx)(w.Wv,{asChild:!0,children:(0,a.jsxs)(x.$,{variant:"outline",className:"w-[140px] justify-start text-left font-normal ".concat(!ex.endDate&&"text-muted-foreground"),children:[(0,a.jsx)(E.A,{className:"mr-2 h-4 w-4"}),ex.endDate?(0,r.GP)(new Date(ex.endDate),"MMM d, yyyy"):(0,a.jsx)("span",{children:"Pick end date"})]})}),(0,a.jsx)(w.hl,{className:"w-auto p-0",align:"start",side:"bottom",onInteractOutside:e=>e.preventDefault(),onPointerDownOutside:e=>e.preventDefault(),children:(0,a.jsx)(N.R,{mode:"single",selected:ex.endDate?new Date(ex.endDate):void 0,onSelect:e=>{e9("endDate",e7(e)),es(!1)},initialFocus:!0})})]})]})]})]})]}),(0,a.jsx)(v.lG,{open:H,onOpenChange:e=>{X(e),e||sc()},children:(0,a.jsxs)(v.Cf,{children:[(0,a.jsxs)(v.c7,{children:[(0,a.jsx)(v.L3,{children:"Create New Requirement"}),(0,a.jsx)(v.rr,{children:"Fill in the details to create a new requirement."})]}),(0,a.jsxs)(b.tU,{value:W,onValueChange:_,className:"w-full",children:[(0,a.jsxs)(b.j7,{className:"grid w-full grid-cols-2",children:[(0,a.jsx)(b.Xi,{value:"general",disabled:eV,children:"General"}),(0,a.jsx)(b.Xi,{value:"details",disabled:eV,children:"Details"})]}),(0,a.jsx)(b.av,{value:"general",children:(0,a.jsxs)("div",{className:"grid gap-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(j.J,{htmlFor:"taskTitle",children:"Requirement Title"}),(0,a.jsx)(g.p,{id:"taskTitle",placeholder:"Enter requirement title",value:h.taskTitle,onChange:e=>G({...h,taskTitle:e.target.value})})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(j.J,{htmlFor:"taskDesciption",children:"Requirement Description"}),(0,a.jsx)(g.p,{id:"taskDesciption",placeholder:"Enter requirement description",value:h.taskDesciption,onChange:e=>G({...h,taskDesciption:e.target.value})})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(j.J,{htmlFor:"category",children:"Category"}),(0,a.jsxs)(f.l6,{value:h.category,onValueChange:e=>G({...h,category:e}),children:[(0,a.jsx)(f.bq,{className:"w-[280px]",children:(0,a.jsx)(f.yv,{placeholder:"Select a category"})}),(0,a.jsx)(f.gC,{position:"popper",sideOffset:4,children:(0,a.jsx)(f.eb,{value:"Requirement",children:"Requirement"})})]})]}),(0,a.jsxs)("div",{className:"flex justify-between mt-4",children:[(0,a.jsx)(x.$,{variant:"outline",onClick:()=>{X(!1),sc()},children:"Cancel"}),(0,a.jsx)(x.$,{onClick:()=>{eU(!0),setTimeout(()=>{_("details"),eU(!1)},500)},disabled:eV,children:eV?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(A.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Loading..."]}):"Next"})]})]})}),(0,a.jsx)(b.av,{value:"details",children:(0,a.jsxs)("div",{className:"grid gap-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(j.J,{htmlFor:"dueDate",children:"Due Date"}),(0,a.jsxs)(w.AM,{modal:!1,open:Y,onOpenChange:Z,children:[(0,a.jsx)(w.Wv,{asChild:!0,children:(0,a.jsxs)(x.$,{variant:"outline",className:"w-[280px] justify-start text-left font-normal ".concat(!h.dueDate&&"text-muted-foreground"),children:[(0,a.jsx)(E.A,{className:"mr-2 h-4 w-4"}),h.dueDate?(0,r.GP)(new Date(h.dueDate),"PPP"):(0,a.jsx)("span",{children:"Pick a date"})]})}),(0,a.jsx)(w.hl,{className:"w-auto p-0",align:"start",side:"bottom",onInteractOutside:e=>e.preventDefault(),onPointerDownOutside:e=>e.preventDefault(),children:(0,a.jsx)(N.R,{mode:"single",selected:h.dueDate?new Date(h.dueDate):void 0,onSelect:e=>{if(e){let s=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0"),l="".concat(s,"-").concat(t,"-").concat(a);G({...h,dueDate:l})}else G({...h,dueDate:""});Z(!1)},initialFocus:!0})})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsxs)(j.J,{htmlFor:"assignedToId",children:["Assigned To ",eL&&e$.length>0&&(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"(Team Members Only)"})]}),(0,a.jsx)(y.A,{options:e0,value:eY,onChange:e=>{if(eZ(e),e.length>0){let s=sa.find(s=>s.id.toString()===e[0]);G({...h,assignedToId:parseInt(e[0]),assignedToName:s?"".concat(s.firstName," ").concat(s.lastName):"Unknown",storeId:0,storeName:""}),eb([]),eK([]),st()}else G({...h,assignedToId:0,assignedToName:"",storeId:0,storeName:""}),eb([]),eK([])},placeholder:eL&&0===e$.length&&ef.length>0?"Loading team members...":"Select an employee",searchPlaceholder:"Search employees...",className:"w-[280px]"})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(j.J,{htmlFor:"priority",children:"Priority"}),(0,a.jsxs)(f.l6,{value:h.priority,onValueChange:e=>G({...h,priority:e}),children:[(0,a.jsx)(f.bq,{className:"w-[280px]",children:(0,a.jsx)(f.yv,{placeholder:"Select a priority"})}),(0,a.jsxs)(f.gC,{position:"popper",sideOffset:4,children:[(0,a.jsx)(f.eb,{value:"low",children:"Low"}),(0,a.jsx)(f.eb,{value:"medium",children:"Medium"}),(0,a.jsx)(f.eb,{value:"high",children:"High"})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(j.J,{htmlFor:"storeId",children:"Store"}),(0,a.jsx)(y.A,{options:e4,value:eQ,onChange:e=>{if(eK(e),e.length>0){let s=ew.find(s=>s.id.toString()===e[0]);G({...h,storeId:parseInt(e[0]),storeName:s?s.storeName:"Unknown"})}else G({...h,storeId:0,storeName:""})},placeholder:eW?"Loading stores...":"Select a store",searchPlaceholder:"Search stores...",className:"w-[280px]",disabled:eW})]}),(0,a.jsxs)("div",{className:"flex justify-between mt-4",children:[(0,a.jsx)(x.$,{variant:"outline",onClick:()=>{_("general")},children:"Back"}),(0,a.jsx)(x.$,{onClick:sr,disabled:eH,children:eH?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(A.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):"Create Requirement"})]})]})})]})]})}),eg?(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)(A.A,{className:"w-8 h-8 animate-spin text-primary"})}):0===eh?(0,a.jsxs)("div",{className:"text-center py-10",children:[(0,a.jsx)(I.A,{className:"w-16 h-16 text-yellow-500 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-xl font-semibold",children:"No requirements found."}),(0,a.jsx)("p",{className:"text-gray-500 mt-2",children:"Try adjusting your filters or create a new requirement."})]}):(0,a.jsx)("div",{className:"flex flex-wrap -mx-2",children:e.map((e,s)=>(0,a.jsx)(o.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*s},className:"w-full sm:w-1/2 lg:w-1/3 p-2",children:(0,a.jsxs)(D.Zp,{className:"relative h-full overflow-visible shadow-lg transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl",children:[(0,a.jsxs)(D.aR,{className:"pb-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)(p.E,{className:"".concat(sm(e.status).color," px-3 py-1 rounded-full font-semibold flex items-center space-x-2"),children:[sm(e.status).icon," ",(0,a.jsx)("span",{children:e.status})]}),(0,a.jsxs)(k.rI,{children:[(0,a.jsx)(k.ty,{asChild:!0,children:(0,a.jsx)(x.$,{variant:"ghost",size:"sm",children:(0,a.jsx)(F.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(k.SQ,{align:"end",children:[(0,a.jsxs)(k._2,{onClick:()=>(e=>{try{sessionStorage.setItem("nav.return.to",JSON.stringify({page:"requirements"}))}catch(e){}$.push("/dashboard/customers/".concat(e))})(e.storeId),children:[(0,a.jsx)(q.A,{className:"mr-2 h-4 w-4"})," View Store"]}),(0,a.jsxs)(k._2,{onClick:()=>{var s;return s=e.assignedToId,void $.push("/dashboard/employees/".concat(s))},children:[(0,a.jsx)(R.A,{className:"mr-2 h-4 w-4"})," View Field Officer"]}),(0,a.jsx)(k.mB,{}),(0,a.jsxs)(k._2,{onClick:()=>(e=>{eP(e),eO(e.id),eq(e.status),eE(!0)})(e),children:[(0,a.jsx)(C.A,{className:"mr-2 h-4 w-4"})," Change Status"]}),(0,a.jsx)(k.mB,{}),(0,a.jsxs)(k._2,{onClick:()=>sd(e.id),className:"text-red-600",children:[(0,a.jsx)(O.A,{className:"mr-2 h-4 w-4"})," Delete Requirement"]})]})]})]}),(0,a.jsx)(D.ZB,{className:"text-xl mt-2",children:e.taskTitle||"Untitled Requirement"}),(0,a.jsxs)(D.BT,{className:"flex items-center mt-1 text-card-foreground",children:[(0,a.jsx)(q.A,{className:"w-4 h-4 mr-2 text-primary"}),e.storeName]})]}),(0,a.jsxs)(D.Wu,{children:[e.taskDesciption&&(0,a.jsxs)("div",{className:"relative group mb-4 pb-4 border-b border-border",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-card-foreground dark:text-white line-clamp-2",children:e.taskDesciption}),e.taskDesciption.length>80&&(0,a.jsx)("div",{className:"pointer-events-none absolute left-1/2 bottom-full z-50 mb-3 w-full max-w-md -translate-x-1/2 -translate-y-2 rounded-xl border border-primary/40 bg-black p-4 text-white shadow-2xl opacity-0 invisible transition-all duration-200 group-hover:visible group-hover:opacity-100 group-hover:translate-y-0",children:(0,a.jsx)("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:e.taskDesciption})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(R.A,{className:"w-4 h-4 text-indigo-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm text-white",children:"Assigned to"}),(0,a.jsx)("p",{className:"font-medium",children:e.assignedToName})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(J.A,{className:"w-4 h-4 text-purple-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm text-white",children:"Priority"}),(0,a.jsx)("p",{className:"font-medium capitalize",children:e.priority})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-white",children:[(0,a.jsx)(E.A,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:["Due: ",(0,r.GP)(new Date(e.dueDate),"MMM d, yyyy")]})]})]})]})},e.id))}),ec>1&&(0,a.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(j.J,{htmlFor:"pageSize",children:"Rows per page:"}),(0,a.jsxs)(f.l6,{value:ed.toString(),onValueChange:e=>eo(parseInt(e)),children:[(0,a.jsx)(f.bq,{className:"w-20",children:(0,a.jsx)(f.yv,{})}),(0,a.jsxs)(f.gC,{children:[(0,a.jsx)(f.eb,{value:"10",children:"10"}),(0,a.jsx)(f.eb,{value:"25",children:"25"}),(0,a.jsx)(f.eb,{value:"50",children:"50"}),(0,a.jsx)(f.eb,{value:"100",children:"100"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(x.$,{variant:"outline",size:"sm",onClick:()=>en(Math.max(0,ei-1)),disabled:0===ei,children:[(0,a.jsx)(B.A,{className:"h-4 w-4"}),"Previous"]}),(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Page ",ei+1," of ",ec]}),(0,a.jsxs)(x.$,{variant:"outline",size:"sm",onClick:()=>en(Math.min(ec-1,ei+1)),disabled:ei>=ec-1,children:["Next",(0,a.jsx)(L.A,{className:"h-4 w-4"})]})]})]}),(0,a.jsx)(v.lG,{open:eM,onOpenChange:e=>{e?eE(!0):si()},children:(0,a.jsxs)(v.Cf,{className:"sm:max-w-lg",children:[(0,a.jsxs)(v.c7,{children:[(0,a.jsx)(v.L3,{children:"Change Status"}),(0,a.jsxs)(v.rr,{children:["Update the workflow state for"," ",(0,a.jsx)("strong",{children:(null==eI?void 0:eI.taskTitle)||"this requirement"}),"."]})]}),eI&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-3 rounded-xl border border-border/60 bg-muted/30 p-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:"Requirement"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-card-foreground",children:eI.taskTitle||"Untitled Requirement"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:eI.storeName})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs uppercase text-muted-foreground",children:"Assigned To"}),(0,a.jsx)("p",{className:"font-semibold text-card-foreground",children:eI.assignedToName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs uppercase text-muted-foreground",children:"Due Date"}),(0,a.jsx)("p",{className:"font-semibold text-card-foreground",children:eI.dueDate?(0,r.GP)(new Date(eI.dueDate),"MMM d, yyyy"):"Not set"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"text-xs uppercase text-muted-foreground",children:"Current Status"}),(0,a.jsx)(p.E,{variant:"secondary",className:"text-xs",children:eI.status})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(j.J,{htmlFor:"status",children:"New Status"}),(0,a.jsxs)(f.l6,{value:eF,onValueChange:eq,children:[(0,a.jsx)(f.bq,{id:"status",className:"w-full",children:(0,a.jsx)(f.yv,{placeholder:"Select new status"})}),(0,a.jsx)(f.gC,{children:["Assigned","Work In Progress","Complete"].map(e=>(0,a.jsx)(f.eb,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)(x.$,{variant:"outline",onClick:si,children:"Cancel"}),(0,a.jsx)(x.$,{onClick:sn,disabled:!eF||eF===eI.status,children:"Update Status"})]})]})]})}),(0,a.jsx)(S.cj,{open:eA,onOpenChange:eT,children:(0,a.jsxs)(S.h,{side:"right",className:"w-[300px] sm:w-[400px]",children:[(0,a.jsx)(S.Fm,{children:(0,a.jsx)(S.qp,{children:"Filter Requirements"})}),(0,a.jsxs)("div",{className:"space-y-6 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(j.J,{className:"text-sm font-medium",children:"Employee"}),(0,a.jsxs)(f.l6,{value:ex.employee,onValueChange:e=>so("employee",e),children:[(0,a.jsx)(f.bq,{children:(0,a.jsx)(f.yv,{placeholder:"Filter by employee"})}),(0,a.jsxs)(f.gC,{children:[(0,a.jsx)(f.eb,{value:"all",children:"All Employees"}),eN.map(e=>(0,a.jsx)(f.eb,{value:e.id.toString(),children:e.name},e.id))]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(j.J,{className:"text-sm font-medium",children:"Priority"}),(0,a.jsxs)(f.l6,{value:ex.priority,onValueChange:e=>so("priority",e),children:[(0,a.jsx)(f.bq,{children:(0,a.jsx)(f.yv,{placeholder:"Filter by priority"})}),(0,a.jsxs)(f.gC,{children:[(0,a.jsx)(f.eb,{value:"all",children:"All Priorities"}),(0,a.jsx)(f.eb,{value:"low",children:"Low"}),(0,a.jsx)(f.eb,{value:"medium",children:"Medium"}),(0,a.jsx)(f.eb,{value:"high",children:"High"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(j.J,{className:"text-sm font-medium",children:"Status"}),(0,a.jsxs)(f.l6,{value:ex.status,onValueChange:e=>so("status",e),children:[(0,a.jsx)(f.bq,{children:(0,a.jsx)(f.yv,{placeholder:"Filter by status"})}),(0,a.jsxs)(f.gC,{children:[(0,a.jsx)(f.eb,{value:"all",children:"All Open Statuses"}),(0,a.jsx)(f.eb,{value:"Assigned",children:"Assigned"}),(0,a.jsx)(f.eb,{value:"Work In Progress",children:"Work In Progress"}),(0,a.jsx)(f.eb,{value:"Complete",children:"Complete"})]})]})]}),!eL&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(j.J,{className:"text-sm font-medium",children:"Start Date"}),(0,a.jsxs)(w.AM,{open:et,onOpenChange:ea,children:[(0,a.jsx)(w.Wv,{asChild:!0,children:(0,a.jsxs)(x.$,{variant:"outline",className:"w-full justify-start text-left font-normal ".concat(!ex.startDate&&"text-muted-foreground"),children:[(0,a.jsx)(E.A,{className:"mr-2 h-4 w-4"}),ex.startDate?(0,r.GP)(new Date(ex.startDate),"MMM d, yyyy"):(0,a.jsx)("span",{children:"Pick start date"})]})}),(0,a.jsx)(w.hl,{className:"w-auto p-0",children:(0,a.jsx)(N.R,{mode:"single",selected:ex.startDate?new Date(ex.startDate):void 0,onSelect:e=>{e9("startDate",e7(e)),ea(!1)},initialFocus:!0})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(j.J,{className:"text-sm font-medium",children:"End Date"}),(0,a.jsxs)(w.AM,{open:el,onOpenChange:er,children:[(0,a.jsx)(w.Wv,{asChild:!0,children:(0,a.jsxs)(x.$,{variant:"outline",className:"w-full justify-start text-left font-normal ".concat(!ex.endDate&&"text-muted-foreground"),children:[(0,a.jsx)(E.A,{className:"mr-2 h-4 w-4"}),ex.endDate?(0,r.GP)(new Date(ex.endDate),"MMM d, yyyy"):(0,a.jsx)("span",{children:"Pick end date"})]})}),(0,a.jsx)(w.hl,{className:"w-auto p-0",children:(0,a.jsx)(N.R,{mode:"single",selected:ex.endDate?new Date(ex.endDate):void 0,onSelect:e=>{e9("endDate",e7(e)),er(!1)},initialFocus:!0})})]})]})]})]}),(0,a.jsxs)(S.XW,{className:"flex gap-2",children:[(0,a.jsx)(x.$,{variant:"outline",onClick:()=>{ep({search:"",employee:"all",priority:"all",status:"all",startDate:"",endDate:""})},children:"Clear All"}),(0,a.jsx)(x.$,{onClick:()=>eT(!1),children:"Apply Filters"})]})]})})]})}},72390:(e,s,t)=>{Promise.resolve().then(t.bind(t,69250))}},e=>{e.O(0,[9358,9,1052,1691,4627,2462,4806,924,9687,8237,2622,8441,1255,7358],()=>e(e.s=72390)),_N_E=e.O()}]);