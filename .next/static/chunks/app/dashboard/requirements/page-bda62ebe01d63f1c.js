(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6706],{31856:(e,s,t)=>{"use strict";t.d(s,{CG:()=>c,Fm:()=>p,XW:()=>g,cj:()=>o,h:()=>x,qp:()=>j});var a=t(95155),l=t(12115),r=t(89511),i=t(83101),n=t(65229),d=t(25016);let o=r.bL,c=r.l9;r.bm;let m=r.ZL,h=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.hJ,{className:(0,d.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...l,ref:s})});h.displayName=r.hJ.displayName;let u=(0,i.F)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),x=l.forwardRef((e,s)=>{let{side:t="right",className:l,children:i,...o}=e;return(0,a.jsxs)(m,{children:[(0,a.jsx)(h,{}),(0,a.jsxs)(r.UC,{ref:s,className:(0,d.cn)(u({side:t}),l),...o,children:[i,(0,a.jsxs)(r.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,a.jsx)(n.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});x.displayName=r.UC.displayName;let p=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,d.cn)("flex flex-col space-y-2 text-center sm:text-left",s),...t})};p.displayName="SheetHeader";let g=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,d.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};g.displayName="SheetFooter";let j=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.hE,{ref:s,className:(0,d.cn)("text-lg font-semibold text-foreground",t),...l})});j.displayName=r.hE.displayName,l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(r.VY,{ref:s,className:(0,d.cn)("text-sm text-muted-foreground",t),...l})}).displayName=r.VY.displayName},69250:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>z});var a=t(95155),l=t(12115),r=t(71163),i=t(20063),n=t(82466),d=t(37621),o=t(68209),c=t(1733),m=t(61927),h=t.n(m),u=t(63270),x=t.n(u),p=t(97003),g=t(67812),j=t(33789),f=t(90235),y=t(47507),N=t(98432),v=t(60028),w=t(54679),b=t(97450),D=t(90923),k=t(83209),S=t(7220),C=t(31856),A=t(26983),T=t(42348),I=t(42529),P=t(52056),M=t(46826),F=t(66955),q=t(16485),E=t(37772),O=t(71871),R=t(20508),J=t(71360),B=t(30814),L=t(90368),$=t(27937);let z=()=>{let[e,s]=(0,l.useState)([]),[t,m]=(0,l.useState)([]),[u,z]=(0,l.useState)({id:0,taskTitle:"",taskDesciption:"",dueDate:"",assignedToId:0,assignedToName:"",assignedById:86,status:"Assigned",priority:"low",category:"Requirement",storeId:0,storeName:"",storeCity:"",taskType:"requirement"}),G=(0,i.useRouter)(),V="requirements.filters.v1",[U,W]=(0,l.useState)(!1),[_,H]=(0,l.useState)("general"),[X,Y]=(0,l.useState)(!1),[Z,Q]=(0,l.useState)(!1),[K,ee]=(0,l.useState)(!1),[es,et]=(0,l.useState)(!1),[ea,el]=(0,l.useState)(!1),[er,ei]=(0,l.useState)(!1),[en,ed]=(0,l.useState)(0),[eo,ec]=(0,l.useState)(10),[em,eh]=(0,l.useState)(0),[eu,ex]=(0,l.useState)(0),[ep,eg]=(0,l.useState)({employee:"",priority:"",status:"",search:"",startDate:(0,r.GP)(new Date,"yyyy-MM-dd"),endDate:(0,r.GP)(new Date,"yyyy-MM-dd")}),[ej,ef]=(0,l.useState)(!0),[ey,eN]=(0,l.useState)([]),[ev,ew]=(0,l.useState)([]),[eb,eD]=(0,l.useState)([]),[ek,eS]=(0,l.useState)(null),[eC,eA]=(0,l.useState)(null),[eT,eI]=(0,l.useState)(!1),[eP,eM]=(0,l.useState)(null),[eF,eq]=(0,l.useState)(!1),[eE,eO]=(0,l.useState)(""),[eR,eJ]=(0,l.useState)(null),[eB,eL]=(0,l.useState)(null),[e$,ez]=(0,l.useState)(!1),[eG,eV]=(0,l.useState)([]),[eU,eW]=(0,l.useState)(!1),[e_,eH]=(0,l.useState)(!1),[eX,eY]=(0,l.useState)(!1),[eZ,eQ]=(0,l.useState)([]),[eK,e0]=(0,l.useState)([]),[e2,e4]=(0,l.useState)([]),[e1,e6]=(0,l.useState)([]),{token:e5,userRole:e3,userData:e8,currentUser:e7}=(0,n.A)();(0,l.useEffect)(()=>{ez((0,o.co)(e3,e7))},[e3,e7]),(0,l.useEffect)(()=>{let e=async()=>{if(e$&&(null==e8?void 0:e8.employeeId))try{console.log("Loading team data for manager with employeeId:",e8.employeeId);let e=await d.n.getTeamByEmployee(e8.employeeId);if(e&&e.length>0){let s=e[0],t=s.id;eL(t),console.log("Team ID loaded:",t);let a=s.fieldOfficers.map(e=>e.id);console.log("Team member IDs:",a);let l=ey.filter(e=>a.includes(e.id));eV(l),console.log("Team members loaded:",l.length)}else console.warn("No team data found for manager"),eS("No team data found for this manager")}catch(e){console.error("Failed to load team data:",e),eS("Failed to load team data")}};e$&&(null==e8?void 0:e8.employeeId)&&ey.length>0&&e()},[e$,null==e8?void 0:e8.employeeId,ey]),(0,l.useEffect)(()=>{if(ek){let e=setTimeout(()=>{eS(null)},2e4);return()=>clearTimeout(e)}},[ek]);let e9=e=>{if(!e)return"";let s=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return"".concat(s,"-").concat(t,"-").concat(a)},se=(e,s)=>{eg({...ep,[e]:s})},ss=(0,l.useCallback)(async()=>{if(e5){if(e$&&!eB)return void console.log("â³ Manager detected but no teamId yet - waiting for team data");console.log("Fetching tasks with:",{userRole:e3,userData:e8,isManager:e$,teamId:eB,token:e5?"present":"missing"}),ef(!0);try{let e;if(e$&&eB)e="https://api.gajkesaristeels.in/task/getByTeam?id=".concat(eB),console.log("Using MANAGER API:",e,"Team ID:",eB);else{let s=(0,r.GP)(new Date(ep.startDate),"yyyy-MM-dd"),t=(0,r.GP)(new Date(ep.endDate),"yyyy-MM-dd");e="https://api.gajkesaristeels.in/task/getByDate?start=".concat(s,"&end=").concat(t),console.log("Using ADMIN API:",e,"User Role:",e3)}let t=await fetch(e,{headers:{Authorization:"Bearer ".concat(e5)}});if(!t.ok){let e=await t.text();throw console.error("API Error:",t.status,e),Error("API request failed: ".concat(t.status," ").concat(e))}let a=await t.json();console.log("API Response:",a);let l=(Array.isArray(a)?a:[]).filter(e=>"requirement"===e.taskType).map(e=>({id:Number(e.id)||0,taskTitle:String(e.taskTitle||""),taskDesciption:String(e.taskDesciption||e.taskDescription||""),dueDate:String(e.dueDate||""),assignedToId:Number(e.assignedToId)||0,assignedToName:String(e.assignedToName||"Unknown"),assignedById:Number(e.assignedById)||0,status:String(e.status||""),priority:String(e.priority||""),category:String(e.category||""),storeId:Number(e.storeId)||0,storeName:String(e.storeName||""),storeCity:String(e.storeCity||""),taskType:String(e.taskType||"")})).sort((e,s)=>new Date(s.dueDate).getTime()-new Date(e.dueDate).getTime()),i=en*eo,n=i+eo,d=l.slice(i,n);s(d),eh(Math.ceil(l.length/eo)),ex(l.length),ef(!1)}catch(e){console.error("Error fetching tasks:",e),ef(!1)}}},[ep,e5,e3,e8,e$,eB,en,eo]),st=(0,l.useCallback)(async()=>{if(e5)try{let e=await fetch("https://api.gajkesaristeels.in/employee/getAll",{headers:{Authorization:"Bearer ".concat(e5)}}),s=await e.json(),t=h()(s,e=>"".concat(e.firstName," ").concat(e.lastName));eN(t)}catch(e){console.error("Error fetching employees:",e)}},[e5]),sa=(0,l.useCallback)(async()=>{if(e5){eH(!0);try{let e=await fetch("https://api.gajkesaristeels.in/store/names",{headers:{Authorization:"Bearer ".concat(e5)}}),s=await e.json();eD(s)}catch(e){console.error("Error fetching stores:",e)}finally{eH(!1)}}},[e5]);(0,l.useEffect)(()=>{try{let e=sessionStorage.getItem(V);if(e){let s=JSON.parse(e);(null==s?void 0:s.filters)&&eg(e=>({...e,...s.filters})),"number"==typeof(null==s?void 0:s.currentPage)&&ed(s.currentPage),"number"==typeof(null==s?void 0:s.pageSize)&&ec(s.pageSize)}}catch(e){}W(!0)},[]),(0,l.useEffect)(()=>{if(U)try{sessionStorage.setItem(V,JSON.stringify({filters:ep,currentPage:en,pageSize:eo}))}catch(e){}},[ep,en,eo,U]),(0,l.useEffect)(()=>{U&&ss()},[ss,eB,U]),(0,l.useEffect)(()=>{ed(0)},[ep]),(0,l.useEffect)(()=>{st()},[st]);let sl=e$&&eG.length>0?eG:ey;(0,l.useEffect)(()=>{X&&sa()},[X,sa]),(0,l.useEffect)(()=>{if(e.length>0){let s=x()(e.map(e=>({id:e.assignedToId,name:e.assignedToName})),"id");ew(h()(s,"name"))}},[e]),(0,l.useEffect)(()=>{sr()},[e,ep]),(0,l.useEffect)(()=>{e4((e$&&eG.length>0?eG:ey).map(e=>({value:e.id.toString(),label:"".concat(e.firstName," ").concat(e.lastName)})).sort((e,s)=>e.label.localeCompare(s.label)))},[ey,eG,e$]),(0,l.useEffect)(()=>{e6(eb.map(e=>({value:e.id.toString(),label:e.storeName})).sort((e,s)=>e.label.localeCompare(s.label)))},[eb]);let sr=()=>{let s=ep.search.toLowerCase();m(e.filter(e=>{var t,a,l,r;return"requirement"===e.taskType&&(((null==(t=e.taskTitle)?void 0:t.toLowerCase())||"").includes(s)||((null==(a=e.taskDesciption)?void 0:a.toLowerCase())||"").includes(s)||((null==(l=e.storeName)?void 0:l.toLowerCase())||"").includes(s)||((null==(r=e.assignedToName)?void 0:r.toLowerCase())||"").includes(s))&&(""===ep.employee||"all"===ep.employee||e.assignedToId===parseInt(ep.employee))&&(""===ep.priority||"all"===ep.priority||e.priority===ep.priority)&&(""===ep.status||"all"===ep.status?"Complete"!==e.status:e.status===ep.status)&&(!!e$||(""===ep.startDate||new Date(e.dueDate)>=new Date(ep.startDate))&&(""===ep.endDate||new Date(e.dueDate)<=new Date(ep.endDate)))}))},si=async()=>{if(e5){eY(!0);try{var e,t,a;let l={...u,taskDesciption:u.taskDesciption,taskType:"requirement"},r=await fetch("https://api.gajkesaristeels.in/task/create",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e5)},body:JSON.stringify(l)}),i=await r.json(),n={...u,id:i.id,assignedToName:(null==(e=sl.find(e=>e.id===u.assignedToId))?void 0:e.firstName)+" "+(null==(t=sl.find(e=>e.id===u.assignedToId))?void 0:t.lastName)||"Unknown",storeName:(null==(a=eb.find(e=>e.id===u.storeId))?void 0:a.storeName)||""};s(e=>[n,...e]),Y(!1),sm()}catch(e){console.error("Error creating task:",e)}finally{eY(!1)}}},sn=()=>{eq(!1),eJ(null),eO(""),eM(null)},sd=async()=>{if(e5&&null!==eR){if(eP&&eE===eP.status)return void sn();try{(await fetch("https://api.gajkesaristeels.in/task/updateTask?taskId=".concat(eR),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e5)},body:JSON.stringify({status:eE})})).ok?(s(e=>e.map(e=>e.id===eR?{...e,status:eE}:e)),sn()):console.error("Failed to update task status")}catch(e){console.error("Error updating task status:",e)}}},so=async e=>{if(e5)try{await fetch("https://api.gajkesaristeels.in/task/deleteById?taskId=".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e5)}}),ss()}catch(e){console.error("Error deleting task:",e)}},sc=(e,s)=>{eg(t=>({...t,[e]:s})),sr()},sm=()=>{z({id:0,taskTitle:"",taskDesciption:"",dueDate:"",assignedToId:0,assignedToName:"",assignedById:86,status:"Assigned",priority:"low",category:"Requirement",storeId:0,storeName:"",storeCity:"",taskType:"requirement"}),eQ([]),e0([]),eD([]),H("general")},sh=e=>{switch(e.toLowerCase()){case"assigned":return{icon:(0,a.jsx)(A.A,{className:"w-4 h-4"}),color:"bg-purple-100 text-purple-800"};case"work in progress":return{icon:(0,a.jsx)(T.A,{className:"w-4 h-4 animate-spin"}),color:"bg-blue-100 text-blue-800"};case"complete":return{icon:(0,a.jsx)(I.A,{className:"w-4 h-4"}),color:"bg-green-100 text-green-800"};default:return{icon:(0,a.jsx)(P.A,{className:"w-4 h-4"}),color:"bg-gray-100 text-gray-800"}}};return(0,a.jsxs)("div",{className:"container mx-auto py-6 px-4 sm:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"mb-6 flex flex-wrap gap-4 items-center",children:[(0,a.jsxs)("div",{className:"flex-grow lg:flex-grow-0 lg:w-64 flex items-center gap-2",children:[(0,a.jsx)(j.p,{placeholder:"Search requirements",value:ep.search,onChange:e=>sc("search",e.target.value),className:"w-full"}),(0,a.jsxs)(p.$,{onClick:()=>Y(!0),children:[(0,a.jsx)(M.A,{className:"w-4 h-4 mr-2"})," New"]})]}),(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsxs)(p.$,{variant:"outline",size:"sm",className:"lg:hidden",onClick:()=>eI(!0),children:[(0,a.jsx)(F.A,{className:"w-4 h-4 mr-2"}),"Filters"]})}),(0,a.jsxs)("div",{className:"hidden lg:flex flex-wrap gap-4 items-center",children:[(0,a.jsxs)(y.l6,{value:ep.employee,onValueChange:e=>sc("employee",e),children:[(0,a.jsx)(y.bq,{className:"w-[200px]",children:(0,a.jsx)(y.yv,{placeholder:"Filter by employee"})}),(0,a.jsxs)(y.gC,{children:[(0,a.jsx)(y.eb,{value:"all",children:"All Employees"}),ev.map(e=>(0,a.jsx)(y.eb,{value:e.id.toString(),children:e.name},e.id))]})]}),(0,a.jsxs)(y.l6,{value:ep.priority,onValueChange:e=>sc("priority",e),children:[(0,a.jsx)(y.bq,{className:"w-[200px]",children:(0,a.jsx)(y.yv,{placeholder:"Filter by priority"})}),(0,a.jsxs)(y.gC,{children:[(0,a.jsx)(y.eb,{value:"all",children:"All Priorities"}),(0,a.jsx)(y.eb,{value:"low",children:"Low"}),(0,a.jsx)(y.eb,{value:"medium",children:"Medium"}),(0,a.jsx)(y.eb,{value:"high",children:"High"})]})]}),(0,a.jsxs)(y.l6,{value:ep.status,onValueChange:e=>sc("status",e),children:[(0,a.jsx)(y.bq,{className:"w-[200px]",children:(0,a.jsx)(y.yv,{placeholder:"Filter by status"})}),(0,a.jsxs)(y.gC,{children:[(0,a.jsx)(y.eb,{value:"all",children:"All Open Statuses"}),(0,a.jsx)(y.eb,{value:"Assigned",children:"Assigned"}),(0,a.jsx)(y.eb,{value:"Work In Progress",children:"Work In Progress"}),(0,a.jsx)(y.eb,{value:"Complete",children:"Complete"})]})]}),!e$&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(f.J,{htmlFor:"startDate",children:"From:"}),(0,a.jsxs)(b.AM,{modal:!1,open:K,onOpenChange:ee,children:[(0,a.jsx)(b.Wv,{asChild:!0,children:(0,a.jsxs)(p.$,{variant:"outline",className:"w-[140px] justify-start text-left font-normal ".concat(!ep.startDate&&"text-muted-foreground"),children:[(0,a.jsx)(q.A,{className:"mr-2 h-4 w-4"}),ep.startDate?(0,r.GP)(new Date(ep.startDate),"MMM d, yyyy"):(0,a.jsx)("span",{children:"Pick start date"})]})}),(0,a.jsx)(b.hl,{className:"w-auto p-0",align:"start",side:"bottom",onInteractOutside:e=>e.preventDefault(),onPointerDownOutside:e=>e.preventDefault(),children:(0,a.jsx)(v.R,{mode:"single",selected:ep.startDate?new Date(ep.startDate):void 0,onSelect:e=>{se("startDate",e9(e)),ee(!1)},initialFocus:!0})})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(f.J,{htmlFor:"endDate",children:"To:"}),(0,a.jsxs)(b.AM,{modal:!1,open:es,onOpenChange:et,children:[(0,a.jsx)(b.Wv,{asChild:!0,children:(0,a.jsxs)(p.$,{variant:"outline",className:"w-[140px] justify-start text-left font-normal ".concat(!ep.endDate&&"text-muted-foreground"),children:[(0,a.jsx)(q.A,{className:"mr-2 h-4 w-4"}),ep.endDate?(0,r.GP)(new Date(ep.endDate),"MMM d, yyyy"):(0,a.jsx)("span",{children:"Pick end date"})]})}),(0,a.jsx)(b.hl,{className:"w-auto p-0",align:"start",side:"bottom",onInteractOutside:e=>e.preventDefault(),onPointerDownOutside:e=>e.preventDefault(),children:(0,a.jsx)(v.R,{mode:"single",selected:ep.endDate?new Date(ep.endDate):void 0,onSelect:e=>{se("endDate",e9(e)),et(!1)},initialFocus:!0})})]})]})]})]})]}),(0,a.jsx)(w.lG,{open:X,onOpenChange:e=>{Y(e),e||sm()},children:(0,a.jsxs)(w.Cf,{children:[(0,a.jsxs)(w.c7,{children:[(0,a.jsx)(w.L3,{children:"Create New Requirement"}),(0,a.jsx)(w.rr,{children:"Fill in the details to create a new requirement."})]}),(0,a.jsxs)(D.tU,{value:_,onValueChange:H,className:"w-full",children:[(0,a.jsxs)(D.j7,{className:"grid w-full grid-cols-2",children:[(0,a.jsx)(D.Xi,{value:"general",disabled:eU,children:"General"}),(0,a.jsx)(D.Xi,{value:"details",disabled:eU,children:"Details"})]}),(0,a.jsx)(D.av,{value:"general",children:(0,a.jsxs)("div",{className:"grid gap-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(f.J,{htmlFor:"taskTitle",children:"Requirement Title"}),(0,a.jsx)(j.p,{id:"taskTitle",placeholder:"Enter requirement title",value:u.taskTitle,onChange:e=>z({...u,taskTitle:e.target.value})})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(f.J,{htmlFor:"taskDesciption",children:"Requirement Description"}),(0,a.jsx)(j.p,{id:"taskDesciption",placeholder:"Enter requirement description",value:u.taskDesciption,onChange:e=>z({...u,taskDesciption:e.target.value})})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(f.J,{htmlFor:"category",children:"Category"}),(0,a.jsxs)(y.l6,{value:u.category,onValueChange:e=>z({...u,category:e}),children:[(0,a.jsx)(y.bq,{className:"w-[280px]",children:(0,a.jsx)(y.yv,{placeholder:"Select a category"})}),(0,a.jsx)(y.gC,{position:"popper",sideOffset:4,children:(0,a.jsx)(y.eb,{value:"Requirement",children:"Requirement"})})]})]}),(0,a.jsxs)("div",{className:"flex justify-between mt-4",children:[(0,a.jsx)(p.$,{variant:"outline",onClick:()=>{Y(!1),sm()},children:"Cancel"}),(0,a.jsx)(p.$,{onClick:()=>{eW(!0),setTimeout(()=>{H("details"),eW(!1)},500)},disabled:eU,children:eU?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(T.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Loading..."]}):"Next"})]})]})}),(0,a.jsx)(D.av,{value:"details",children:(0,a.jsxs)("div",{className:"grid gap-4",children:[(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(f.J,{htmlFor:"dueDate",children:"Due Date"}),(0,a.jsxs)(b.AM,{modal:!1,open:Z,onOpenChange:Q,children:[(0,a.jsx)(b.Wv,{asChild:!0,children:(0,a.jsxs)(p.$,{variant:"outline",className:"w-[280px] justify-start text-left font-normal ".concat(!u.dueDate&&"text-muted-foreground"),children:[(0,a.jsx)(q.A,{className:"mr-2 h-4 w-4"}),u.dueDate?(0,r.GP)(new Date(u.dueDate),"PPP"):(0,a.jsx)("span",{children:"Pick a date"})]})}),(0,a.jsx)(b.hl,{className:"w-auto p-0",align:"start",side:"bottom",onInteractOutside:e=>e.preventDefault(),onPointerDownOutside:e=>e.preventDefault(),children:(0,a.jsx)(v.R,{mode:"single",selected:u.dueDate?new Date(u.dueDate):void 0,onSelect:e=>{if(e){let s=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0"),l="".concat(s,"-").concat(t,"-").concat(a);z({...u,dueDate:l})}else z({...u,dueDate:""});Q(!1)},initialFocus:!0})})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsxs)(f.J,{htmlFor:"assignedToId",children:["Assigned To ",e$&&eG.length>0&&(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"(Team Members Only)"})]}),(0,a.jsx)(N.A,{options:e2,value:eZ,onChange:e=>{if(eQ(e),e.length>0){let s=sl.find(s=>s.id.toString()===e[0]);z({...u,assignedToId:parseInt(e[0]),assignedToName:s?"".concat(s.firstName," ").concat(s.lastName):"Unknown",storeId:0,storeName:""}),eD([]),e0([]),sa()}else z({...u,assignedToId:0,assignedToName:"",storeId:0,storeName:""}),eD([]),e0([])},placeholder:e$&&0===eG.length&&ey.length>0?"Loading team members...":"Select an employee",searchPlaceholder:"Search employees...",className:"w-[280px]"})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(f.J,{htmlFor:"priority",children:"Priority"}),(0,a.jsxs)(y.l6,{value:u.priority,onValueChange:e=>z({...u,priority:e}),children:[(0,a.jsx)(y.bq,{className:"w-[280px]",children:(0,a.jsx)(y.yv,{placeholder:"Select a priority"})}),(0,a.jsxs)(y.gC,{position:"popper",sideOffset:4,children:[(0,a.jsx)(y.eb,{value:"low",children:"Low"}),(0,a.jsx)(y.eb,{value:"medium",children:"Medium"}),(0,a.jsx)(y.eb,{value:"high",children:"High"})]})]})]}),(0,a.jsxs)("div",{className:"grid gap-2",children:[(0,a.jsx)(f.J,{htmlFor:"storeId",children:"Store"}),(0,a.jsx)(N.A,{options:e1,value:eK,onChange:e=>{if(e0(e),e.length>0){let s=eb.find(s=>s.id.toString()===e[0]);z({...u,storeId:parseInt(e[0]),storeName:s?s.storeName:"Unknown"})}else z({...u,storeId:0,storeName:""})},placeholder:e_?"Loading stores...":"Select a store",searchPlaceholder:"Search stores...",className:"w-[280px]",disabled:e_})]}),(0,a.jsxs)("div",{className:"flex justify-between mt-4",children:[(0,a.jsx)(p.$,{variant:"outline",onClick:()=>{H("general")},children:"Back"}),(0,a.jsx)(p.$,{onClick:si,disabled:eX,children:eX?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(T.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):"Create Requirement"})]})]})})]})]})}),ej?(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)(T.A,{className:"w-8 h-8 animate-spin text-primary"})}):0===eu?(0,a.jsxs)("div",{className:"text-center py-10",children:[(0,a.jsx)(P.A,{className:"w-16 h-16 text-yellow-500 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-xl font-semibold",children:"No requirements found."}),(0,a.jsx)("p",{className:"text-gray-500 mt-2",children:"Try adjusting your filters or create a new requirement."})]}):(0,a.jsx)("div",{className:"flex flex-wrap -mx-2",children:e.map((e,s)=>(0,a.jsx)(c.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*s},className:"w-full sm:w-1/2 lg:w-1/3 p-2",children:(0,a.jsxs)(k.Zp,{className:"relative h-full overflow-visible shadow-lg transition-all duration-300 hover:-translate-y-1 hover:shadow-2xl",children:[(0,a.jsxs)(k.aR,{className:"pb-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)(g.E,{className:"".concat(sh(e.status).color," px-3 py-1 rounded-full font-semibold flex items-center space-x-2"),children:[sh(e.status).icon," ",(0,a.jsx)("span",{children:e.status})]}),(0,a.jsxs)(S.rI,{children:[(0,a.jsx)(S.ty,{asChild:!0,children:(0,a.jsx)(p.$,{variant:"ghost",size:"sm",children:(0,a.jsx)(E.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(S.SQ,{align:"end",children:[(0,a.jsxs)(S._2,{onClick:()=>(e=>{try{sessionStorage.setItem("nav.return.to",JSON.stringify({page:"requirements"}))}catch(e){}G.push("/dashboard/customers/".concat(e))})(e.storeId),children:[(0,a.jsx)(O.A,{className:"mr-2 h-4 w-4"})," View Store"]}),(0,a.jsxs)(S._2,{onClick:()=>{var s;return s=e.assignedToId,void G.push("/dashboard/employees/".concat(s))},children:[(0,a.jsx)(R.A,{className:"mr-2 h-4 w-4"})," View Field Officer"]}),(0,a.jsx)(S.mB,{}),(0,a.jsxs)(S._2,{onClick:()=>(e=>{eM(e),eJ(e.id),eO(e.status),eq(!0)})(e),children:[(0,a.jsx)(A.A,{className:"mr-2 h-4 w-4"})," Change Status"]}),(0,a.jsx)(S.mB,{}),(0,a.jsxs)(S._2,{onClick:()=>so(e.id),className:"text-red-600",children:[(0,a.jsx)(J.A,{className:"mr-2 h-4 w-4"})," Delete Requirement"]})]})]})]}),(0,a.jsx)(k.ZB,{className:"text-xl mt-2",children:e.taskTitle||"Untitled Requirement"}),(0,a.jsxs)(k.BT,{className:"flex items-center mt-1 text-card-foreground",children:[(0,a.jsx)(O.A,{className:"w-4 h-4 mr-2 text-primary"}),e.storeName]})]}),(0,a.jsxs)(k.Wu,{children:[e.taskDesciption&&(0,a.jsxs)("div",{className:"relative group mb-4 pb-4 border-b border-border",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-card-foreground dark:text-white line-clamp-2",children:e.taskDesciption}),e.taskDesciption.length>80&&(0,a.jsx)("div",{className:"pointer-events-none absolute left-1/2 bottom-full z-50 mb-3 w-full max-w-md -translate-x-1/2 -translate-y-2 rounded-xl border border-primary/40 bg-black p-4 text-white shadow-2xl opacity-0 invisible transition-all duration-200 group-hover:visible group-hover:opacity-100 group-hover:translate-y-0",children:(0,a.jsx)("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:e.taskDesciption})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(R.A,{className:"w-4 h-4 text-indigo-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm text-white",children:"Assigned to"}),(0,a.jsx)("p",{className:"font-medium",children:e.assignedToName})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(B.A,{className:"w-4 h-4 text-purple-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-sm text-white",children:"Priority"}),(0,a.jsx)("p",{className:"font-medium capitalize",children:e.priority})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-white",children:[(0,a.jsx)(q.A,{className:"w-4 h-4"}),(0,a.jsxs)("span",{children:["Due: ",(0,r.GP)(new Date(e.dueDate),"MMM d, yyyy")]})]})]})]})},e.id))}),em>1&&(0,a.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(f.J,{htmlFor:"pageSize",children:"Rows per page:"}),(0,a.jsxs)(y.l6,{value:eo.toString(),onValueChange:e=>ec(parseInt(e)),children:[(0,a.jsx)(y.bq,{className:"w-20",children:(0,a.jsx)(y.yv,{})}),(0,a.jsxs)(y.gC,{children:[(0,a.jsx)(y.eb,{value:"10",children:"10"}),(0,a.jsx)(y.eb,{value:"25",children:"25"}),(0,a.jsx)(y.eb,{value:"50",children:"50"}),(0,a.jsx)(y.eb,{value:"100",children:"100"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(p.$,{variant:"outline",size:"sm",onClick:()=>ed(Math.max(0,en-1)),disabled:0===en,children:[(0,a.jsx)(L.A,{className:"h-4 w-4"}),"Previous"]}),(0,a.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Page ",en+1," of ",em]}),(0,a.jsxs)(p.$,{variant:"outline",size:"sm",onClick:()=>ed(Math.min(em-1,en+1)),disabled:en>=em-1,children:["Next",(0,a.jsx)($.A,{className:"h-4 w-4"})]})]})]}),(0,a.jsx)(w.lG,{open:eF,onOpenChange:e=>{e?eq(!0):sn()},children:(0,a.jsxs)(w.Cf,{className:"sm:max-w-lg",children:[(0,a.jsxs)(w.c7,{children:[(0,a.jsx)(w.L3,{children:"Change Status"}),(0,a.jsxs)(w.rr,{children:["Update the workflow state for"," ",(0,a.jsx)("strong",{children:(null==eP?void 0:eP.taskTitle)||"this requirement"}),"."]})]}),eP&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-3 rounded-xl border border-border/60 bg-muted/30 p-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:"Requirement"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-card-foreground",children:eP.taskTitle||"Untitled Requirement"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:eP.storeName})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs uppercase text-muted-foreground",children:"Assigned To"}),(0,a.jsx)("p",{className:"font-semibold text-card-foreground",children:eP.assignedToName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs uppercase text-muted-foreground",children:"Due Date"}),(0,a.jsx)("p",{className:"font-semibold text-card-foreground",children:eP.dueDate?(0,r.GP)(new Date(eP.dueDate),"MMM d, yyyy"):"Not set"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{className:"text-xs uppercase text-muted-foreground",children:"Current Status"}),(0,a.jsx)(g.E,{variant:"secondary",className:"text-xs",children:eP.status})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{htmlFor:"status",children:"New Status"}),(0,a.jsxs)(y.l6,{value:eE,onValueChange:eO,children:[(0,a.jsx)(y.bq,{id:"status",className:"w-full",children:(0,a.jsx)(y.yv,{placeholder:"Select new status"})}),(0,a.jsx)(y.gC,{children:["Assigned","Work In Progress","Complete"].map(e=>(0,a.jsx)(y.eb,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,a.jsx)(p.$,{variant:"outline",onClick:sn,children:"Cancel"}),(0,a.jsx)(p.$,{onClick:sd,disabled:!eE||eE===eP.status,children:"Update Status"})]})]})]})}),(0,a.jsx)(C.cj,{open:eT,onOpenChange:eI,children:(0,a.jsxs)(C.h,{side:"right",className:"w-[300px] sm:w-[400px]",children:[(0,a.jsx)(C.Fm,{children:(0,a.jsx)(C.qp,{children:"Filter Requirements"})}),(0,a.jsxs)("div",{className:"space-y-6 py-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"Employee"}),(0,a.jsxs)(y.l6,{value:ep.employee,onValueChange:e=>sc("employee",e),children:[(0,a.jsx)(y.bq,{children:(0,a.jsx)(y.yv,{placeholder:"Filter by employee"})}),(0,a.jsxs)(y.gC,{children:[(0,a.jsx)(y.eb,{value:"all",children:"All Employees"}),ev.map(e=>(0,a.jsx)(y.eb,{value:e.id.toString(),children:e.name},e.id))]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"Priority"}),(0,a.jsxs)(y.l6,{value:ep.priority,onValueChange:e=>sc("priority",e),children:[(0,a.jsx)(y.bq,{children:(0,a.jsx)(y.yv,{placeholder:"Filter by priority"})}),(0,a.jsxs)(y.gC,{children:[(0,a.jsx)(y.eb,{value:"all",children:"All Priorities"}),(0,a.jsx)(y.eb,{value:"low",children:"Low"}),(0,a.jsx)(y.eb,{value:"medium",children:"Medium"}),(0,a.jsx)(y.eb,{value:"high",children:"High"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"Status"}),(0,a.jsxs)(y.l6,{value:ep.status,onValueChange:e=>sc("status",e),children:[(0,a.jsx)(y.bq,{children:(0,a.jsx)(y.yv,{placeholder:"Filter by status"})}),(0,a.jsxs)(y.gC,{children:[(0,a.jsx)(y.eb,{value:"all",children:"All Open Statuses"}),(0,a.jsx)(y.eb,{value:"Assigned",children:"Assigned"}),(0,a.jsx)(y.eb,{value:"Work In Progress",children:"Work In Progress"}),(0,a.jsx)(y.eb,{value:"Complete",children:"Complete"})]})]})]}),!e$&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"Start Date"}),(0,a.jsxs)(b.AM,{open:ea,onOpenChange:el,children:[(0,a.jsx)(b.Wv,{asChild:!0,children:(0,a.jsxs)(p.$,{variant:"outline",className:"w-full justify-start text-left font-normal ".concat(!ep.startDate&&"text-muted-foreground"),children:[(0,a.jsx)(q.A,{className:"mr-2 h-4 w-4"}),ep.startDate?(0,r.GP)(new Date(ep.startDate),"MMM d, yyyy"):(0,a.jsx)("span",{children:"Pick start date"})]})}),(0,a.jsx)(b.hl,{className:"w-auto p-0",children:(0,a.jsx)(v.R,{mode:"single",selected:ep.startDate?new Date(ep.startDate):void 0,onSelect:e=>{se("startDate",e9(e)),el(!1)},initialFocus:!0})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(f.J,{className:"text-sm font-medium",children:"End Date"}),(0,a.jsxs)(b.AM,{open:er,onOpenChange:ei,children:[(0,a.jsx)(b.Wv,{asChild:!0,children:(0,a.jsxs)(p.$,{variant:"outline",className:"w-full justify-start text-left font-normal ".concat(!ep.endDate&&"text-muted-foreground"),children:[(0,a.jsx)(q.A,{className:"mr-2 h-4 w-4"}),ep.endDate?(0,r.GP)(new Date(ep.endDate),"MMM d, yyyy"):(0,a.jsx)("span",{children:"Pick end date"})]})}),(0,a.jsx)(b.hl,{className:"w-auto p-0",children:(0,a.jsx)(v.R,{mode:"single",selected:ep.endDate?new Date(ep.endDate):void 0,onSelect:e=>{se("endDate",e9(e)),ei(!1)},initialFocus:!0})})]})]})]})]}),(0,a.jsxs)(C.XW,{className:"flex gap-2",children:[(0,a.jsx)(p.$,{variant:"outline",onClick:()=>{eg({search:"",employee:"all",priority:"all",status:"all",startDate:"",endDate:""})},children:"Clear All"}),(0,a.jsx)(p.$,{onClick:()=>eI(!1),children:"Apply Filters"})]})]})})]})}},72390:(e,s,t)=>{Promise.resolve().then(t.bind(t,69250))}},e=>{e.O(0,[9358,9,1052,1691,7715,7362,4806,6452,9687,9480,2622,8441,1255,7358],()=>e(e.s=72390)),_N_E=e.O()}]);